<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
<mapper namespace="SmmsEventMain"> 
<sql id="listColumns">
	
            ssp.RID,
            ssp.EVENT_SOURCE,
            ssp.CLIENTNAME,
            ssp.REPORT_CITY,
            ssp.EVENT_TYPE1,
            ssp.THREAT_LEVEL,
            ssp.THREAT_NAME,
            ssp.THREAT_TYPE1,
            ssp.THREAT_TYPE2,
            ssp.THREAT_TYPE3,
            ssp.THREAT_TYPE4,
            ssp.ACCESS_ID,
            ssp.ROOM_NAME,
            ssp.ROOM_IDX,
            ssp.DOMAIN_NAME,
            ssp.CC_DOMAIN,
            ssp.IP,
            ssp.ATTACK_IP,
            ssp.SYS_RECTIFY_SUGGEST,
            ssp.FINAL_RECTIFY_SUGGEST,
            ssp.IS_FORCE_CLOSE,
            ssp.IS_WHITE_LIST,
            ssp.FORCE_CLOSE_DESC,
            ssp.RECTIFY_TERM,
            ssp.CLOSE_TERM,
            ssp.SEND_TIME,
            ssp.SEND_TIMESTAMP,
            ssp.RECTIFY_STATE,
            ssp.RECTIFY_MEASURE,
            ssp.FEEDBACK_TIME,
            ssp.FEEDBACK_TIMESTAMP,
            ssp.WEB_CASE_RID,
            ssp.MAPPING_MODE,
            ssp.MEMO,
            ssp.CREATTIME,
            ssp.MODIFIEDTIME,
            ssp.RECORDSTATE,
            ssp.KEYWORDS,
            ssp.SNAPSHOP,
            ssp.DETIAL_COUNT,
            ssp.ENFORCE_COUNT,
            ssp.ENFORCE_TIME,
            ssp.ENFORCE_USER,
            ssp.RECTIFY_COUNT,
            ssp.CLOSE_COUNT,
            ssp.DETAIL_RID,
            ssp.URL,
            ssp.PRIORITY,
            ssp.EVENT_INDEX,
       		sii.IDC_ID,
            sii.IDC_NAME,
            use.USERNAME
</sql>
<sql id="detailColumns">
	
            ssp.RID,
            ssp.EVENT_SOURCE,
            ssp.CLIENTNAME,
            ssp.REPORT_CITY,
            ssp.EVENT_TYPE1,
            ssp.THREAT_LEVEL,
            ssp.THREAT_NAME,
            ssp.THREAT_TYPE1,
            ssp.THREAT_TYPE2,
            ssp.THREAT_TYPE3,
            ssp.THREAT_TYPE4,
            ssp.ACCESS_ID,
            ssp.ROOM_NAME,
            ssp.ROOM_IDX,
            ssp.DOMAIN_NAME,
            ssp.CC_DOMAIN,
            ssp.IP,
            ssp.ATTACK_IP,
            ssp.SYS_RECTIFY_SUGGEST,
            ssp.FINAL_RECTIFY_SUGGEST,
            ssp.IS_FORCE_CLOSE,
            ssp.IS_WHITE_LIST,
            ssp.FORCE_CLOSE_DESC,
            ssp.RECTIFY_TERM,
            ssp.CLOSE_TERM,
            ssp.SEND_TIME,
            ssp.SEND_TIMESTAMP,
            ssp.RECTIFY_STATE,
            ssp.RECTIFY_MEASURE,
            ssp.FEEDBACK_TIME,
            ssp.FEEDBACK_TIMESTAMP,
            ssp.WEB_CASE_RID,
            ssp.MAPPING_MODE,
            ssp.MEMO,
            ssp.CREATTIME,
            ssp.MODIFIEDTIME,
            ssp.RECORDSTATE,
            ssp.KEYWORDS,
            ssp.SNAPSHOP,
            ssp.DETIAL_COUNT,
            ssp.ENFORCE_COUNT,
            ssp.ENFORCE_TIME,
            ssp.ENFORCE_USER,
            ssp.RECTIFY_COUNT,
            ssp.CLOSE_COUNT,
            ssp.DETAIL_RID,
            ssp.URL,
            ssp.PRIORITY,
            ssp.EVENT_INDEX,
       		sii.IDC_ID,
            sii.IDC_NAME,
            use.USERNAME
</sql>
<sql id="listColumnsByRid">
	
            RID as EVENT_MAINRID,
            EVENT_SOURCE,
            CLIENTNAME,
            REPORT_CITY,
            EVENT_TYPE1,
            THREAT_LEVEL,
            THREAT_NAME,
            THREAT_TYPE1,
            THREAT_TYPE2,
            THREAT_TYPE3,
            THREAT_TYPE4,
            ACCESS_ID,
            ROOM_NAME,
            ROOM_IDX,
            DOMAIN_NAME,
            CC_DOMAIN,
            IP,
            ATTACK_IP,
            SYS_RECTIFY_SUGGEST,
            FINAL_RECTIFY_SUGGEST,
            IS_FORCE_CLOSE,
            IS_WHITE_LIST,
            FORCE_CLOSE_DESC,
            RECTIFY_TERM,
            CLOSE_TERM,
            SEND_TIME,
            SEND_TIMESTAMP,
            RECTIFY_STATE,
            RECTIFY_MEASURE,
            FEEDBACK_TIME,
            FEEDBACK_TIMESTAMP,
            WEB_CASE_RID,
            MAPPING_MODE,
            MEMO,
            CREATTIME,
            MODIFIEDTIME,
            RECORDSTATE,
            KEYWORDS,
            SNAPSHOP,
            DETIAL_COUNT,
            ENFORCE_COUNT,
            ENFORCE_TIME,
            ENFORCE_USER,
            EVENT_INDEX,
            PRIORITY,
            URL
</sql>

<select id="listData" parameterType="hashmap" resultType="hashmap"> 
	select sii.IDC_NAME as TRANS_IDC_ID,ssw.WEBSITE_NAME as TRANS_WEB_CASE_RID,
 	ssp.DETIAL_COUNT  as TRANS_RID,<include refid="listColumns"/>
	from SMMS_EVENT_MAIN as ssp
	left join smms_idc_info as sii
    on ssp.ACCESS_ID=sii.IDC_ID
     left join 
    	SMMS_WEB_CASE as ssw
    	on ssp.WEB_CASE_RID=ssw.RID
    left join 
    	S_USER as use
    	on ssp.ENFORCE_USER=use.USERID
	<where>
		ssp.RECORDSTATE='0'  
        <if test="whereCondition!=null and whereCondition!='' ">   
             ${whereCondition}
        </if>	
	</where>
        <if test="order!=null and order!='' ">   
             order by ${order}
        </if>				
</select> 
<select id="findEventMainInfo" parameterType="hashmap" resultType="hashmap"> 
	select RECTIFY_STATE,CREATTIME,ENFORCE_COUNT,CLOSE_COUNT,THREAT_TYPE4,KEYWORDS,IS_FORCE_CLOSE,PRIORITY,THREAT_LEVEL,THREAT_TYPE1,THREAT_TYPE2 ,FINAL_RECTIFY_SUGGEST from SMMS_EVENT_MAIN where RECORDSTATE='0' and  RID=#{RID}			
</select> 
<select id="countWebCaseRidTotal" parameterType="hashmap" resultType="hashmap"> 
select count(main.WEB_CASE_RID) as WEBCASETOTAL,max(main.rid) as MAIN_RID ,max(main.DETIAL_COUNT) as DETIAL_COUNT ,max(main.CLOSE_COUNT) as CLOSE_COUNT,max(main.RECTIFY_STATE) as RECTIFY_STATE,max(main.CREATTIME) as CREATTIME,max(main.ENFORCE_COUNT) as ENFORCE_COUNT,max(main.THREAT_TYPE4) as THREAT_TYPE4,max(main.KEYWORDS) as KEYWORDS,max(main.IS_FORCE_CLOSE) as IS_FORCE_CLOSE,max(main.PRIORITY) as PRIORITY,max(main.THREAT_LEVEL) as THREAT_LEVEL, 
 max(THREAT_TYPE1) as THREAT_TYPE1,max(THREAT_TYPE2) as THREAT_TYPE2,max(FINAL_RECTIFY_SUGGEST) as FINAL_RECTIFY_SUGGEST from SMMS_EVENT_MAIN as main 
where main.RECORDSTATE='0' and  main.WEB_CASE_RID=#{WEB_CASE_RID}			
</select> 
<select id="countDomainTotal" parameterType="hashmap" resultType="hashmap"> 
select count(main.DOMAIN_NAME) as DOMAINTOTAL,max(main.rid) as MAIN_RID,max(main.DETIAL_COUNT) as DETIAL_COUNT,max(main.CLOSE_COUNT) as CLOSE_COUNT, max(main.RECTIFY_STATE) as RECTIFY_STATE,max(main.CREATTIME) as CREATTIME,max(main.ENFORCE_COUNT) as ENFORCE_COUNT,max(main.THREAT_TYPE4) as THREAT_TYPE4,max(main.KEYWORDS) as KEYWORDS,max(main.IS_FORCE_CLOSE) as IS_FORCE_CLOSE,max(main.PRIORITY) as PRIORITY,max(main.THREAT_LEVEL) as THREAT_LEVEL ,
   max(THREAT_TYPE1) as THREAT_TYPE1,max(THREAT_TYPE2) as THREAT_TYPE2,max(FINAL_RECTIFY_SUGGEST) as FINAL_RECTIFY_SUGGEST   from SMMS_EVENT_MAIN as main 
where main.RECORDSTATE='0' and main.DOMAIN_NAME=#{DOMAIN_NAME} 
</select> 
<select id="countIpTotal" parameterType="hashmap" resultType="hashmap"> 
select count(main.IP) as IPTOTAL,max(main.rid) as MAIN_RID,max(main.DETIAL_COUNT) as DETIAL_COUNT,max(main.CLOSE_COUNT) as CLOSE_COUNT, max(main.RECTIFY_STATE) as RECTIFY_STATE,max(main.CREATTIME) as CREATTIME,max(main.ENFORCE_COUNT) as ENFORCE_COUNT,max(main.THREAT_TYPE4) as THREAT_TYPE4,max(main.KEYWORDS) as KEYWORDS ,max(main.IS_FORCE_CLOSE) as IS_FORCE_CLOSE,max(main.PRIORITY) as PRIORITY,max(main.THREAT_LEVEL) as THREAT_LEVEL ,
 max(THREAT_TYPE1) as THREAT_TYPE1,max(THREAT_TYPE2) as THREAT_TYPE2,max(FINAL_RECTIFY_SUGGEST) as FINAL_RECTIFY_SUGGEST	from SMMS_EVENT_MAIN as main 
where main.RECORDSTATE='0' and main.IP=#{IP} 
</select> 
<select id="selectModifiedTime" resultType="hashmap"> 
      select RID as EVENT_RID,MODIFIEDTIME,ACCESS_ID from SMMS_EVENT_MAIN 
      where RECORDSTATE = '0' 
      and RECTIFY_STATE = '020' and IS_FORCE_CLOSE = '2'
</select> 

<select id="dealRectify" parameterType="hashmap" resultType="hashmap"> 
   select RID, MAIN_RID, OCCUR_TIME
   from smms_pending_event
   where MAIN_RID = #{EVENT_RID} 
    <![CDATA[AND #{MODIFIEDTIME} < OCCUR_TIME ]]> 
</select> 
<select id="findEventMainMessage" parameterType="hashmap" resultType="hashmap"> 
	select <include refid="listColumnsByRid"/> from SMMS_EVENT_MAIN where   RID=#{EVENT_RID}			
</select> 
<select id="findEventMainUrl" parameterType="hashmap" resultType="hashmap"> 
	select  EVENT_TYPE1,THREAT_TYPE1,THREAT_TYPE4 from SMMS_EVENT_MAIN where   RID=#{RID}			
</select> 

<select id="getCountWebCaseRid" parameterType="hashmap" resultType="hashmap"> 
	select count(*) as NO_CASE  from smms_event_main 
			where RECORDSTATE='0' 
			and (WEB_CASE_RID is null or WEB_CASE_RID='')	
			and  ACCESS_ID is not null and ACCESS_ID!=''
				
</select> 
<!-- 当月累计安全数 -->
<select id="getCountModifiedtime" parameterType="hashmap" resultType="hashmap"> 
	select count(*) as MONTH_EVENT from smms_event_main 
		<where> substring(MODIFIEDTIME,1,7)=substring(to_char(CURRENT_DATE,'yyyy-mm-dd'),1,7) 
			and RECORDSTATE='0' 
			and  ACCESS_ID is not null and ACCESS_ID!=''
			<if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
             AND  ACCESS_ID =#{ACCESS_ID}
        </if>
		</where>	 	
</select> 
<!-- 当月处理安全事件数 -->
<select id="getCountRectifyStateEight" parameterType="hashmap" resultType="hashmap"> 
	select count(*) as MONTH_DEALT from smms_event_main 
	     <where> substring(MODIFIEDTIME,1,7)=substring(to_char(CURRENT_DATE,'yyyy-mm-dd'),1,7) 
	       and (RECTIFY_STATE='888' or RECTIFY_STATE='899' or RECTIFY_STATE='020' or RECTIFY_STATE='030' or RECTIFY_STATE='900') 
	       and RECORDSTATE='0' 
	       and  ACCESS_ID is not null and ACCESS_ID!=''
		  	<if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
             AND  ACCESS_ID =#{ACCESS_ID}
        </if>
     </where>
</select> 
<!-- 当月未处理安全数 -->
<select id="getCountRectifyStateNoEight" parameterType="hashmap" resultType="hashmap"> 
	select count(*) as MONTH_NOT_DEAL from smms_event_main 
		<where> substring(MODIFIEDTIME,1,7)=substring(to_char(CURRENT_DATE,'yyyy-mm-dd'),1,7) 
		and RECTIFY_STATE ='000' and RECTIFY_STATE !='' and RECTIFY_STATE is not null 
		and RECORDSTATE='0' 
			<if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
             AND  ACCESS_ID =#{ACCESS_ID}
        </if>
		</where>
</select> 
<!--整改处理idc-->
<!-- 待整改涉及一级 -->
<select id="getCountIdcSs1Dzg" parameterType="hashmap" resultType="hashmap"> 
select count(*) as SS1DZG from smms_event_main as  sse 
<where>
sse.IS_FORCE_CLOSE='2' and sse.RECORDSTATE='0' 
and sse.RECTIFY_STATE='000'
and (sse.threat_type4 like '%010%' or sse.threat_type4 like '%020%' or sse.threat_type4 like '%030%')
and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''	

<!--时间条件--> 
        <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME  &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME  &lt;= #{ENDTIME}
        </if>
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>

<!-- 整改中 涉及一级  -->
<select id="getCountIdcSs1Zgz" parameterType="hashmap" resultType="hashmap"> 
select count(*) as SS1ZGZ from smms_event_main as  sse 
<where> 
sse.IS_FORCE_CLOSE='2' and sse.RECORDSTATE='0' 
and (sse.RECTIFY_STATE='010' or sse.RECTIFY_STATE='999') 
and (sse.threat_type4 like '%010%' or sse.threat_type4 like '%020%' or sse.threat_type4 like '%030%')
and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''	
          <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME  &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME  &lt;= #{ENDTIME}
        </if>	
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>
<!-- 已整改涉及一级  -->
<select id="getCountIdcSs1Yzg" parameterType="hashmap" resultType="hashmap"> 
select count(*) as SS1YZG from smms_event_main as sse 
<where> 
sse.IS_FORCE_CLOSE='2' and sse.RECORDSTATE='0' 
and (sse.RECTIFY_STATE='888' or sse.RECTIFY_STATE='020') 
and (sse.threat_type4 like '%010%' or sse.threat_type4 like '%020%' or sse.threat_type4 like '%030%')
and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''	
        <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME  &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME  &lt;= #{ENDTIME}
        </if>
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>


<!-- 待整改涉及2级 -->
<select id="getCountIdcSs2Dzg" parameterType="hashmap" resultType="hashmap"> 
select count(*) as SS2DZG from smms_event_main as sse 
<where>
sse.IS_FORCE_CLOSE='2' and sse.RECORDSTATE='0' 
and sse.RECTIFY_STATE='000'
and (sse.threat_type4 like '%040%' or sse.threat_type4 like '%050%' or sse.threat_type4 like '%060%')
and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''	

<!--时间条件--> 
         <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME  &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME  &lt;= #{ENDTIME}
        </if>
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>
<!-- 整改中 涉及二级  -->
<select id="getCountIdcSs2Zgz" parameterType="hashmap" resultType="hashmap"> 
select count(*) as SS2ZGZ from smms_event_main as sse 
<where> 
sse.IS_FORCE_CLOSE='2' and sse.RECORDSTATE='0' 
and (sse.RECTIFY_STATE='010' or sse.RECTIFY_STATE='999') 
and (sse.threat_type4 like '%040%' or sse.threat_type4 like '%050%' or sse.threat_type4 like '%060%')
and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''	
        <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME  &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME  &lt;= #{ENDTIME}
        </if>	
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>
<!-- 已整改涉及二级  -->
<select id="getCountIdcSs2Yzg" parameterType="hashmap" resultType="hashmap"> 
select count(*) as SS2YZG from smms_event_main as sse 
<where> 
sse.IS_FORCE_CLOSE='2' and sse.RECORDSTATE='0' 
and (sse.RECTIFY_STATE='888' or sse.RECTIFY_STATE='020') 
and (sse.threat_type4 like '%040%' or sse.threat_type4 like '%050%' or sse.threat_type4 like '%060%')
and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''	
        <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME  &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME  &lt;= #{ENDTIME}
        </if>	
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>
<!-- 安全事件整改 -->
<!-- 待整改 -->
<select id="getCountIdcAqsjDzg" parameterType="hashmap" resultType="hashmap"> 
select count(*) as AQSJDZG from smms_event_main as sse 
<where>
sse.IS_FORCE_CLOSE='2' and sse.RECORDSTATE='0' 
and sse.RECTIFY_STATE='000'

and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''	

<!--时间条件--> 
         <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME  &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME &lt;= #{ENDTIME}
        </if>
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>
<!-- 整改中 -->
<select id="getCountIdcAqsjZgz" parameterType="hashmap" resultType="hashmap"> 
select count(*) as AQSJZGZ from smms_event_main as sse 
<where> 
sse.IS_FORCE_CLOSE='2' and sse.RECORDSTATE='0' 
and (sse.RECTIFY_STATE='010' or sse.RECTIFY_STATE='999') 

and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''	
        <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME  &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME  &lt;= #{ENDTIME}
        </if>
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>
<!-- 已整改  -->
<select id="getCountIdcAqsjYzg" parameterType="hashmap" resultType="hashmap"> 
select count(*) as AQSJYZG from smms_event_main as sse 
<where> 
sse.IS_FORCE_CLOSE='2' and sse.RECORDSTATE='0' 
and (sse.RECTIFY_STATE='888' or sse.RECTIFY_STATE='020') 
and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''	
         <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME  &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME  &lt;= #{ENDTIME}
        </if>	
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>


<!-- 未备案事件整改 -->
<!-- 待整改 -->
<select id="getCountIdcWbaDzg" parameterType="hashmap" resultType="hashmap"> 
select count(*) as WBAJDZG from smms_event_main as sse 
<where>
sse.IS_FORCE_CLOSE='2' and sse.RECORDSTATE='0' 
and sse.RECTIFY_STATE='000'
and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''	
and (sse.WEB_CASE_RID is null or sse.WEB_CASE_RID='')	
<!--时间条件--> 
         <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME  &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME  &lt;= #{ENDTIME}
        </if>
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>
<!-- 整改中 -->
<select id="getCountIdcWbaZgz" parameterType="hashmap" resultType="hashmap"> 
select count(*) as WBAJZGZ from smms_event_main as sse 
<where> 
sse.IS_FORCE_CLOSE='2' and sse.RECORDSTATE='0' 
and (sse.RECTIFY_STATE='010' or sse.RECTIFY_STATE='999') 
and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''	
and (sse.WEB_CASE_RID is null or sse.WEB_CASE_RID='')	
        <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME  &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME  &lt;= #{ENDTIME}
        </if>	
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>
<!-- 已整改  -->
<select id="getCountIdcWbaYzg" parameterType="hashmap" resultType="hashmap"> 
select count(*) as WbaYZG from smms_event_main as sse 
<where> 
sse.IS_FORCE_CLOSE='2' and sse.RECORDSTATE='0' 
and (sse.RECTIFY_STATE='888' or sse.RECTIFY_STATE='020') 
and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''	
and (sse.WEB_CASE_RID is null or sse.WEB_CASE_RID='')	
        <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME  &lt;= #{ENDTIME}
        </if>
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>


<!-- 关停业务分布 -->


	
<!-- 已关停涉及一级 -->
<select id="getCountIdcSs1Ygt" parameterType="hashmap" resultType="hashmap"> 
select count(*) as SS1YGT from smms_event_main as  sse 
<where>
sse.IS_FORCE_CLOSE='1' and sse.RECORDSTATE='0' 
and (sse.RECTIFY_STATE='888' or sse.RECTIFY_STATE='899' or sse.RECTIFY_STATE='020' or sse.RECTIFY_STATE='030' or sse.RECTIFY_STATE='900')
and (sse.threat_type4 like '%010%' or sse.threat_type4 like '%020%' or sse.threat_type4 like '%030%')
and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''	

<!--时间条件--> 
        <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME  &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME  &lt;= #{ENDTIME}
        </if>
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>

<!-- 申请恢复 涉及一级  -->
<select id="getCountIdcSs1Sqhf" parameterType="hashmap" resultType="hashmap"> 
select count(*) as SS1SQHF from smms_event_main as  sse 
<where> 
sse.IS_FORCE_CLOSE='1' and sse.RECORDSTATE='0' 
and sse.RECTIFY_STATE='030'  
and (sse.threat_type4 like '%010%' or sse.threat_type4 like '%020%' or sse.threat_type4 like '%030%')
and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''	
          <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME  &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME  &lt;= #{ENDTIME}
        </if>	
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>
<!-- 关停审核中涉及一级  -->
<select id="getCountIdcSs1CloseShz" parameterType="hashmap" resultType="hashmap"> 
select count(*) as SS1CLOSESHZ from SMMS_WEB_CLOSE_APP as ssc LEFT JOIN
smms_event_main as sse on ssc.EVENT_RID=sse.rid
<where> 
	 ssc.RECORDSTATE='0' and ssc.APP_RESULT='1' 
 and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''
 and (sse.threat_type4 like '%010%' or sse.threat_type4 like '%020%' or sse.threat_type4 like '%030%')	
<!--时间条件--> 
        <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME  &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME  &lt;= #{ENDTIME}
        </if>
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>
<!-- 解封审核中涉及一级  -->
<select id="getCountIdcSs1OpenShz" parameterType="hashmap" resultType="hashmap"> 
select count(*) as SS1OPENSHZ from SMMS_WEB_OPEN_APP as sso LEFT JOIN
smms_event_main as sse on sso.EVENT_RID=sse.rid
<where> 
	 sso.RECORDSTATE='0' and sso.APP_RESULT='1' 
 and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''
 and (sse.threat_type4 like '%010%' or sse.threat_type4 like '%020%' or sse.threat_type4 like '%030%')	
<!--时间条件--> 
        <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME  &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME  &lt;= #{ENDTIME}
        </if>
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>



<!-- 已关停涉及2级 -->
<select id="getCountIdcSs2Ygt" parameterType="hashmap" resultType="hashmap"> 
select count(*) as SS2YGT from smms_event_main as  sse 
<where>
sse.IS_FORCE_CLOSE='1' and sse.RECORDSTATE='0' 
and (sse.RECTIFY_STATE='888' or sse.RECTIFY_STATE='899' or sse.RECTIFY_STATE='020' or sse.RECTIFY_STATE='030' or sse.RECTIFY_STATE='900')
and (sse.threat_type4 like '%040%' or sse.threat_type4 like '%050%' or sse.threat_type4 like '%060%')
and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''	

<!--时间条件--> 
        <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME  &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME  &lt;= #{ENDTIME}
        </if>
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>

<!-- 申请恢复 涉及二级  -->
<select id="getCountIdcSs2Sqhf" parameterType="hashmap" resultType="hashmap"> 
select count(*) as SS2SQHF from smms_event_main as  sse 
<where> 
sse.IS_FORCE_CLOSE='1' and sse.RECORDSTATE='0' 
and sse.RECTIFY_STATE='030'  
and (sse.threat_type4 like '%040%' or sse.threat_type4 like '%050%' or sse.threat_type4 like '%060%')
and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''	
          <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME  &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME  &lt;= #{ENDTIME}
        </if>	
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>
<!-- 关停审核中涉及二级  -->
<select id="getCountIdcSs2CloseShz" parameterType="hashmap" resultType="hashmap"> 
select count(*) as SS2CLOSESHZ from SMMS_WEB_CLOSE_APP as ssc LEFT JOIN
smms_event_main as sse on ssc.EVENT_RID=sse.rid
<where> 
	 ssc.RECORDSTATE='0' and ssc.APP_RESULT='1' 
 and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''
 and (sse.threat_type4 like '%040%' or sse.threat_type4 like '%050%' or sse.threat_type4 like '%060%')	
<!--时间条件--> 
        <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME  &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME  &lt;= #{ENDTIME}
        </if>
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>
<!-- 解封审核中涉及二级  -->
<select id="getCountIdcSs2OpenShz" parameterType="hashmap" resultType="hashmap"> 
select count(*) as SS2OPENSHZ from SMMS_WEB_OPEN_APP as sso LEFT JOIN
smms_event_main as sse on sso.EVENT_RID=sse.rid
<where> 
	 sso.RECORDSTATE='0' and sso.APP_RESULT='1' 
 and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''
 and (sse.threat_type4 like '%040%' or sse.threat_type4 like '%050%' or sse.threat_type4 like '%060%')	
<!--时间条件--> 
        <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME  &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME  &lt;= #{ENDTIME}
        </if>
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>

<!-- 安全事件已关停 -->
<select id="getCountIdcAqsjYgt" parameterType="hashmap" resultType="hashmap"> 
select count(*) as SS2YGT from smms_event_main as  sse 
<where>
sse.IS_FORCE_CLOSE='1' and sse.RECORDSTATE='0' 
and (sse.RECTIFY_STATE='888' or sse.RECTIFY_STATE='899' or sse.RECTIFY_STATE='020' or sse.RECTIFY_STATE='030' or sse.RECTIFY_STATE='900')
and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''	 
        <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME  &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME  &lt;= #{ENDTIME}
        </if>
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>
<!-- 安全事件申请恢复 -->
<select id="getCountIdcAqsjSqhf" parameterType="hashmap" resultType="hashmap"> 
select count(*) as AQSJSQHF from smms_event_main as  sse 
<where> 
sse.IS_FORCE_CLOSE='1' and sse.RECORDSTATE='0' 
and sse.RECTIFY_STATE='030'  
and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''	
          <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME  &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME  &lt;= #{ENDTIME}
        </if>	
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>
<!-- 安全事件关停审核中  -->
<select id="getCountIdcAqsjCloseShz" parameterType="hashmap" resultType="hashmap"> 
select count(*) as AQSJCLOSESHZ from SMMS_WEB_CLOSE_APP as ssc LEFT JOIN
smms_event_main as sse on ssc.EVENT_RID=sse.rid
<where> 
	 ssc.RECORDSTATE='0' and ssc.APP_RESULT='1' 
 and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''
<!--时间条件--> 
        <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME  &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME  &lt;= #{ENDTIME}
        </if>
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>
<!-- 安全事件解封审核中  -->
<select id="getCountIdcAqsjOpenShz" parameterType="hashmap" resultType="hashmap"> 
select count(*) as AQSJOPENSHZ from SMMS_WEB_OPEN_APP as sso LEFT JOIN
smms_event_main as sse on sso.EVENT_RID=sse.rid
<where> 
	 sso.RECORDSTATE='0' and sso.APP_RESULT='1' 
 and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''
<!--时间条件--> 
        <if test="BEGINTIME!=null and BEGINTIME!='' ">   
             and sse.MODIFIEDTIME  &gt;= #{BEGINTIME}
        </if>	
        <if test="ENDTIME!=null and ENDTIME!='' ">   
             and sse.MODIFIEDTIME  &lt;= #{ENDTIME}
        </if>
        <if test="ACCESS_ID!=null and ACCESS_ID!='' ">   
           AND  sse.ACCESS_ID =#{ACCESS_ID}
        </if>
	</where>
</select>


<select id="getCountIsForceCloseOne" parameterType="hashmap" resultType="hashmap"> 
	select count(IS_FORCE_CLOSE) as CLOSED_COUNT from smms_event_main where IS_FORCE_CLOSE='1' and (RECTIFY_STATE='888' or RECTIFY_STATE='899' or RECTIFY_STATE='020' or RECTIFY_STATE='030' or RECTIFY_STATE='900') and RECORDSTATE='0'
</select> 
<select id="getCountIsForceCloseNoOne" parameterType="hashmap" resultType="hashmap"> 
	select count(IS_FORCE_CLOSE) as NEED_CLOSE_COUNT from smms_event_main where IS_FORCE_CLOSE='1' and RECTIFY_STATE ='000' and RECTIFY_STATE !='' and RECTIFY_STATE is not null and RECORDSTATE='0'
</select>
<select id="getCountIsForceCloseTwo" parameterType="hashmap" resultType="hashmap"> 
	select count(IS_FORCE_CLOSE) as RECTIFY_COUNT from smms_event_main where IS_FORCE_CLOSE='2' and (RECTIFY_STATE='888' or RECTIFY_STATE='899' or RECTIFY_STATE='020' or RECTIFY_STATE='030' or RECTIFY_STATE='900') and RECORDSTATE='0'
</select>
<select id="getCountIsForceCloseNoTwo" parameterType="hashmap" resultType="hashmap"> 
	select count(IS_FORCE_CLOSE) as NEED_RECTIFY_COUNT from smms_event_main where IS_FORCE_CLOSE='2' and RECTIFY_STATE ='000' and RECTIFY_STATE !='' and RECTIFY_STATE is not null and RECORDSTATE='0'
</select>

<select id="getCountThreatTypeOneAll" parameterType="hashmap" resultType="hashmap"> 
	select count(threat_type4) as COUNT_THREAT_TYPE4_ALL from smms_event_main 
 where 
    (threat_type4 like '%010%' 
  or
    threat_type4 like '%020%' 
  or
  threat_type4 like '%030%' 
    )
  and 
     RECORDSTATE='0' 
  and 
    threat_type4!='' and threat_type4 is not null
</select>
<select id="getCountThreatTypeOne" parameterType="hashmap" resultType="hashmap"> 
	select count(threat_type4) as KEY_010 from smms_event_main 
 where 
   threat_type4 like '%010%' 
  and 
     RECORDSTATE='0' 
  and 
     threat_type4!='' and threat_type4 is not null
</select>
<select id="getCountThreatTypeTwo" parameterType="hashmap" resultType="hashmap"> 
	select count(threat_type4) as KEY_020 from smms_event_main 
 where 
   threat_type4 like '%020%' 
  and 
     RECORDSTATE='0' 
  and 
     ACCESS_ID is not null and ACCESS_ID!=''
</select>
<select id="getCountThreatTypeThree" parameterType="hashmap" resultType="hashmap"> 
	select count(threat_type4) as KEY_030 from smms_event_main 
 where 
   threat_type4 like '%030%' 
  and 
     RECORDSTATE='0' 
  and 
     ACCESS_ID is not null and ACCESS_ID!=''
</select>

<select id="getCountThreatTypeTwoAll" parameterType="hashmap" resultType="hashmap"> 
	select count(threat_type4) as COUNT_THREAT_TYPE4_ALL from smms_event_main 
 where 
    (threat_type4 like '%040%' 
  or
    threat_type4 like '%050%' 
  or
  threat_type4 like '%060%' 
    )
  and 
     RECORDSTATE='0' 
  and 
     ACCESS_ID is not null and ACCESS_ID!=''
</select>
<select id="getCountThreatTypeFour" parameterType="hashmap" resultType="hashmap"> 
	select count(threat_type4) as KEY_040 from smms_event_main 
 where 
   threat_type4 like '%040%' 
  and 
     RECORDSTATE='0' 
  and 
     ACCESS_ID is not null and ACCESS_ID!=''
</select>
<select id="getCountThreatTypeFive" parameterType="hashmap" resultType="hashmap"> 
	select count(threat_type4) as KEY_050 from smms_event_main 
 where 
   threat_type4 like '%050%' 
  and 
     RECORDSTATE='0' 
  and 
     ACCESS_ID is not null and ACCESS_ID!=''
</select>
<select id="getCountThreatTypeSix" parameterType="hashmap" resultType="hashmap"> 
	select count(threat_type4) as KEY_060 from smms_event_main 
 where 
   threat_type4 like '%060%' 
  and 
     RECORDSTATE='0' 
  and 
     ACCESS_ID is not null and ACCESS_ID!=''
</select>


<select id="getCountThreatTypeAll" parameterType="hashmap" resultType="hashmap"> 
select MAX(idc.idc_short_name) AS IDC_NAME,main.access_id as IDC_ID,main.room_idx as ROOM_IDX,main.threat_type1,count(main.threat_type1) as COUNT_THREAT_TYPE1 
from smms_event_main main
LEFT JOIN smms_idc_info idc
ON idc.idc_id = main.access_id
where 
	main.access_id !='' and main.access_id is not null 
	and main.threat_type1!='99' and main.threat_type1!=''
	 and main.RECORDSTATE='0'
	 and main.room_idx is not null and main.room_idx!=''
GROUP BY main.threat_type1,main.access_id,main.room_idx
ORDER BY main.access_id DESC
</select>

<select id="getCountEventTypeAll" parameterType="hashmap" resultType="hashmap"> 
select MAX(idc.idc_short_name) AS IDC_NAME,main.access_id as IDC_ID,main.room_idx as ROOM_IDX,main.event_type1,count(main.event_type1) as COUNT_EVENT_TYPE1 
from smms_event_main main
LEFT JOIN smms_idc_info idc
ON idc.idc_id = main.access_id
where main.access_id !='' and main.access_id is not null 
 and main.room_idx is not null and main.room_idx!=''
and main.event_type1 !='' and main.event_type1 is not null 
and main.RECORDSTATE='0' and (main.event_type1 = 'vpn' or main.event_type1='vpno' or main.event_type1='proxy')
GROUP BY main.event_type1,main.access_id,main.room_idx
ORDER BY main.access_id DESC
</select>

<select id="getCountThreatByState" parameterType="hashmap" resultType="hashmap"> 
select MAX(idc.idc_short_name) AS IDC_NAME,main.access_id as IDC_ID,main.room_idx as ROOM_IDX,main.threat_type1,count(main.threat_type1) as COUNT_THREAT_TYPE1 
from smms_event_main main
LEFT JOIN smms_idc_info idc
ON idc.idc_id = main.access_id
where main.access_id !='' 
and main.access_id is not null 
and main.threat_type1!='99' 
and main.threat_type1!='' and main.RECORDSTATE='0'
and main.room_idx is not null and main.room_idx!=''
and RECTIFY_STATE !='888' and RECTIFY_STATE !='899' and RECTIFY_STATE !='020' and RECTIFY_STATE !='030' and RECTIFY_STATE !='900' 
GROUP BY main.threat_type1,main.access_id,main.room_idx
ORDER BY main.access_id DESC
</select>

<select id="getCountEventByState" parameterType="hashmap" resultType="hashmap"> 
select MAX(idc.idc_short_name) AS IDC_NAME,main.access_id as IDC_ID,main.room_idx as room_idx,main.event_type1,count(main.event_type1) as COUNT_EVENT_TYPE1 
from smms_event_main main
LEFT JOIN smms_idc_info idc
ON idc.idc_id = main.access_id
where main.access_id !='' 
and main.access_id is not null 
and main.event_type1 !='' 
and main.event_type1 is not null 
and main.RECORDSTATE='0' and (main.event_type1 = 'vpn' or main.event_type1='vpno' or main.event_type1='proxy')
and RECTIFY_STATE !='888' and RECTIFY_STATE !='899' and RECTIFY_STATE !='020' and RECTIFY_STATE !='030' and RECTIFY_STATE !='900' 
GROUP BY main.event_type1,main.access_id,main.room_idx
ORDER BY main.access_id DESC
</select>
<!-- 根据 idc ,统计  威胁细分 -->
<select id="getCountThreatTypeIdcId" parameterType="hashmap" resultType="hashmap"> 
select count(threat_type2) as ALL_COUNT ,ACCESS_ID as IDC_ID  from smms_event_main  
where threat_type2!='' and threat_type2 is not null and RECORDSTATE='0'
and  ACCESS_ID is not null and ACCESS_ID!=''
and ROOM_IDX is not null and ROOM_IDX!='' 
GROUP BY ACCESS_ID


</select>
<!-- 根据 idc 机房 ,统计 威胁细分-->
<select id="getCountThreatTypeRoomIdx" parameterType="hashmap" resultType="hashmap"> 
select threat_type2 as EVENT_NAME,count(threat_type2) as EVENT_COUNT ,ACCESS_ID as IDC_ID ,ROOM_IDX from smms_event_main  
where threat_type2!='' and threat_type2 is not null and RECORDSTATE='0'
and  ACCESS_ID is not null and ACCESS_ID!=''
and ROOM_IDX is not null and ROOM_IDX!='' 
GROUP BY threat_type2, ACCESS_ID,ROOM_IDX	
</select>

<!-- 根据 idc 机房 ,统计 -->
<select id="getCountThreatTypeRoomIdxAll" parameterType="hashmap" resultType="hashmap"> 
select count(threat_type2) as ROOM_COUNT ,ACCESS_ID as IDC_ID ,room_idx from smms_event_main  
where threat_type2!='' and threat_type2 is not null and RECORDSTATE='0'
and  ACCESS_ID is not null and ACCESS_ID!=''
and ROOM_IDX is not null and ROOM_IDX!='' 
GROUP BY  ACCESS_ID,room_idx	
</select>


<select id="getCountThreatTypeToTen" parameterType="hashmap" resultType="hashmap"> 
select threat_type2 as EVENT_NAME,count(threat_type2) as EVENT_COUNT ,ACCESS_ID as IDC_ID from smms_event_main  
where threat_type2!='' and threat_type2 is not null and RECORDSTATE='0'
and  ACCESS_ID is not null and ACCESS_ID!=''
GROUP BY threat_type2, ACCESS_ID	


</select>
<select id="getCountThreatTypeToTenNoDel" parameterType="hashmap" resultType="hashmap"> 
select threat_type2 as EVENT_NAME,count(threat_type2) as EVENT_COUNT,ACCESS_ID as IDC_ID from smms_event_main  
where  RECORDSTATE='0'
and threat_type2!='' and threat_type2 is not null 
and  ACCESS_ID is not null and ACCESS_ID!=''
and RECTIFY_STATE !='888' and RECTIFY_STATE !='899' and RECTIFY_STATE !='020' and RECTIFY_STATE !='030' and RECTIFY_STATE !='900' 
GROUP BY threat_type2,ACCESS_ID


</select>

<!-- 市级页面 2-->
<!-- 统计发生安全个数 -->
<select id="getCountEvent" parameterType="hashmap" resultType="hashmap"> 
select count(*) as AQSJZS from smms_event_main where   RECORDSTATE='0' and ACCESS_ID is not null and ACCESS_ID!=''
</select>

<!-- 统计未处理的安全个数 -->
<select id="getCountEventWcl" parameterType="hashmap" resultType="hashmap"> 
select count(*) as WCLSJS from smms_event_main where   RECORDSTATE='0' and ACCESS_ID is not null and ACCESS_ID!='' and RECTIFY_STATE ='000'
</select>

<!-- 统计已处理的安全个数 -->
<select id="getCountEventYcl" parameterType="hashmap" resultType="hashmap"> 
select count(*) as EVEENT_TOTAL_YCL from smms_event_main where   RECORDSTATE='0' and ACCESS_ID is not null and ACCESS_ID!='' and RECTIFY_STATE !='000'
</select>
<!-- 统计年月统计 -->
<select id="getCountEventGroup" parameterType="hashmap" resultType="hashmap"> 
select count(*) as COUNT_NY,substring(creattime,1,7) as NY from smms_event_main where RECORDSTATE='0' and ACCESS_ID is not null and ACCESS_ID!='' group by substring(creattime,1,7)
</select>
<!-- 信息安全事件 -->
<select id="getCountEventGroupXxaq" parameterType="hashmap" resultType="hashmap"> 
select sse.RID as MAIN_RID,
	sse.DOMAIN_NAME  as DOMAIN_NAME,
				sse.room_name as ROOM_NAME,
				sii.idc_short_name as IDC_NAME,
				ssw.WEBSITE_NAME as WEBSITE_NAME, 
case WHEN sse.RECTIFY_STATE ='000' then '未处理'
         WHEN  sse.RECTIFY_STATE ='999' then '未处理'
          WHEN sse.RECTIFY_STATE ='005' then '未处理'
			WHEN sse.RECTIFY_STATE ='010' then '已下发'
		    WHEN sse.RECTIFY_STATE ='888' then '已关停'
    		WHEN sse.RECTIFY_STATE ='020' then '已关停'
    		WHEN sse.RECTIFY_STATE ='030' then '已关停'
           WHEN sse.RECTIFY_STATE ='900' then '已关停'
           WHEN sse.RECTIFY_STATE ='899' then '已关停'
	   else 
		    RECTIFY_STATE
	   end  as RECTIFY_STATE
      from smms_event_main as sse
      left join smms_idc_info as sii
			on sse.ACCESS_ID=sii.IDC_ID
	   left join 
					SMMS_WEB_CASE as ssw
    	on sse.WEB_CASE_RID=ssw.RID
 	where 
	sse.threat_type4 is not null and sse.threat_type4!=''	
	and  sse.ACCESS_ID is not null and sse.ACCESS_ID!=''
	and 
	sse.RECORDSTATE='0' 
	and 
	WEB_CASE_RID is not null and  WEB_CASE_RID!='' 
	<if test="CONDITION!=null and CONDITION!='' "> ${CONDITION} </if> 
	 ORDER BY sse.ACCESS_ID DESC  
</select>

<!-- 网络安全 -->
<select id="getCountEventGroupWlaq" parameterType="hashmap" resultType="hashmap"> 
select sse.RID as MAIN_RID,
sse.DOMAIN_NAME  as DOMAIN_NAME,
				sse.room_name as ROOM_NAME,
				sii.idc_short_name as IDC_NAME,
				ssw.WEBSITE_NAME as WEBSITE_NAME,
				sse.access_id as IDC_ID, 
case WHEN sse.RECTIFY_STATE ='000' then '未处理'
       WHEN    sse.RECTIFY_STATE ='999' then '未处理'
       WHEN    sse.RECTIFY_STATE ='005' then '未处理'
			WHEN sse.RECTIFY_STATE ='010' then '已下发'
		    WHEN sse.RECTIFY_STATE ='888' then '已关停'
    		WHEN sse.RECTIFY_STATE ='020' then '已关停'
    		WHEN sse.RECTIFY_STATE ='030' then '已关停'
           WHEN sse.RECTIFY_STATE ='900' then '已关停'
           WHEN sse.RECTIFY_STATE ='899' then '已关停'
	   else 
		    RECTIFY_STATE
	   end  as RECTIFY_STATE
      from smms_event_main as sse
      left join smms_idc_info as sii
			on sse.ACCESS_ID=sii.IDC_ID
	   left join 
					SMMS_WEB_CASE as ssw
    	on sse.WEB_CASE_RID=ssw.RID
 	where 
	(sse.THREAT_TYPE1 is not null and  sse.THREAT_TYPE1!='' and sse.THREAT_TYPE1!='99'
	or sse.EVENT_TYPE1='vpno' )
	and  sse.ACCESS_ID is not null and sse.ACCESS_ID!=''
	and 
	sse.RECORDSTATE='0' 
	and 
	WEB_CASE_RID is not null and  WEB_CASE_RID!='' 
	<if test="CONDITION!=null and CONDITION!='' "> ${CONDITION} </if>   
	 ORDER BY sse.ACCESS_ID DESC 
</select>

<!--未备案  -->
<select id="getCountEventWba" parameterType="hashmap" resultType="hashmap"> 
select sse.RID as MAIN_RID,
sse.DOMAIN_NAME  as DOMAIN_NAME,
				sse.room_name as ROOM_NAME,
				sii.idc_short_name as IDC_NAME,
				ssw.WEBSITE_NAME as WEBSITE_NAME, 
case WHEN sse.RECTIFY_STATE ='000' then '未处理'
         WHEN  sse.RECTIFY_STATE ='999' then '未处理'
        WHEN   sse.RECTIFY_STATE ='005' then '未处理'
			WHEN sse.RECTIFY_STATE ='010' then '已下发'
		    WHEN sse.RECTIFY_STATE ='888' then '已关停'
    		WHEN sse.RECTIFY_STATE ='020' then '已关停'
    		WHEN sse.RECTIFY_STATE ='030' then '已关停'
           WHEN sse.RECTIFY_STATE ='900' then '已关停'
           WHEN sse.RECTIFY_STATE ='899' then '已关停'
	   else 
		    RECTIFY_STATE
	   end  as RECTIFY_STATE
      from smms_event_main as sse
      left join smms_idc_info as sii
			on sse.ACCESS_ID=sii.IDC_ID
	   left join 
					SMMS_WEB_CASE as ssw
    	on sse.WEB_CASE_RID=ssw.RID
 	where 
	 sse.ACCESS_ID is not null and sse.ACCESS_ID!=''
	and 
	sse.RECORDSTATE='0' 
	and 
	(WEB_CASE_RID is not null or WEB_CASE_RID!='' )
	<if test="CONDITION!=null and CONDITION!='' "> ${CONDITION} </if>  
	 ORDER BY sse.ACCESS_ID DESC 
</select>
<!--查询所有事件数据-->
<select id="getEventTotal" parameterType="hashmap" resultType="hashmap"> 
select 
sii.IDC_NAME as IDC_NAME,
sse.room_name as ROOM_NAME,
sse.room_idx as ROOM_IDX,	
ssw.WEBSITE_NAME as WEB_CASE_RID, 
case WHEN sse.EVENT_SOURCE ='1' then 'IDC日志'
         WHEN  sse.EVENT_SOURCE ='2' then '其他系统'
        WHEN   sse.EVENT_SOURCE ='3' then '手工添加'
			
	   else 
		    EVENT_SOURCE
	   end  as EVENT_SOURCE,  
sse.DOMAIN_NAME  as DOMAIN_NAME,
sse.ip as IP,
DETIAL_COUNT,
ATTACK_IP,
case WHEN  sse.THREAT_LEVEL ='0' then '未分级'
		 WHEN sse.THREAT_LEVEL ='1' then '低'
         WHEN  sse.THREAT_LEVEL ='2' then '中'
        WHEN   sse.THREAT_LEVEL ='3' then '高'	
	   else 
		    THREAT_LEVEL
	   end  as THREAT_LEVEL, 	
THREAT_TYPE2,
case WHEN sse.PRIORITY ='1' then '低可疑'
         WHEN  sse.PRIORITY ='2' then '高可疑' 
          WHEN  sse.PRIORITY ='3' then '已失陷' 
	   else 
		    PRIORITY
	   end  as PRIORITY,
case WHEN sse.IS_FORCE_CLOSE ='1' then '是'
         WHEN  sse.IS_FORCE_CLOSE ='2' then '否' 
	   else 
		    IS_FORCE_CLOSE
	   end  as IS_FORCE_CLOSE,
case WHEN sse.RECTIFY_STATE ='000' then '未处理'
         WHEN  sse.RECTIFY_STATE ='999' then '未处理'
        WHEN   sse.RECTIFY_STATE ='005' then '未处理'
			WHEN sse.RECTIFY_STATE ='010' then '已下发'
		    WHEN sse.RECTIFY_STATE ='888' then '已关停'
    		WHEN sse.RECTIFY_STATE ='020' then '已关停'
    		WHEN sse.RECTIFY_STATE ='030' then '已关停'
           WHEN sse.RECTIFY_STATE ='900' then '已关停'
           WHEN sse.RECTIFY_STATE ='899' then '已关停'
	   else 
		    RECTIFY_STATE
	   end  as RECTIFY_STATE,

case WHEN sse.RECTIFY_MEASURE ='0' then '未反馈'
         WHEN  sse.RECTIFY_MEASURE ='1' then '已修复'
        WHEN   sse.RECTIFY_MEASURE ='2' then '已关停'
	   else 
		    RECTIFY_MEASURE
	   end  as RECTIFY_MEASURE,
ENFORCE_COUNT,
ENFORCE_TIME,
RECTIFY_COUNT,
CLOSE_COUNT,
ENFORCE_USER,
case WHEN sse.MAPPING_MODE ='0' then '未匹配'
         WHEN  sse.MAPPING_MODE ='1' then 'URL匹配'
        WHEN   sse.MAPPING_MODE ='2' then 'IP匹配'
	   else 
		    MAPPING_MODE
	   end  as MAPPING_MODE,
	   
	  case WHEN sse.FINAL_RECTIFY_SUGGEST ='0' then '未知'
         WHEN  sse.FINAL_RECTIFY_SUGGEST ='1' then '整改'
        WHEN   sse.FINAL_RECTIFY_SUGGEST ='2' then '关停'
	   else 
		    FINAL_RECTIFY_SUGGEST
	   end  as FINAL_RECTIFY_SUGGEST,
	   
	   case WHEN sse.THREAT_TYPE4 ='010' then '涉恐'
         WHEN  sse.THREAT_TYPE4 ='020' then '涉政'
        WHEN   sse.THREAT_TYPE4 ='030' then '涉稳'
			WHEN sse.THREAT_TYPE4 ='040' then '涉黄'
		    WHEN sse.THREAT_TYPE4 ='050' then '涉赌'
    		WHEN sse.THREAT_TYPE4 ='060' then '涉毒'
	   else 
		    THREAT_TYPE4
	   end  as THREAT_TYPE4			  
 from smms_event_main as sse
      left join smms_idc_info as sii
			on sse.ACCESS_ID=sii.IDC_ID
	   left join 
					SMMS_WEB_CASE as ssw
    	on sse.WEB_CASE_RID=ssw.RID
 	<where> 
 	  sse.RECORDSTATE='0'  and sse.ACCESS_ID is not null and sse.ACCESS_ID!=''
 	 
        <if test="CONDITION!=null and CONDITION!='' ">   
             ${CONDITION}
        </if>
        ORDER BY sse.CREATTIME DESC
         <if test="LIMIT!=null and LIMIT!='' ">  LIMIT #{LIMIT}  </if>   
         <if test="OFFSET!=null and OFFSET!='' ">   OFFSET #{OFFSET}  </if>   
          
 	</where>
	
	
</select>
<!--查询详情页面-->
<select id="getEventDetail" parameterType="hashmap" resultType="hashmap"> 
select 
sse.ACCESS_ID as ACCESS_ID,
sii.IDC_NAME as IDC_NAME,
sse.room_name as ROOM_NAME,
sse.room_idx as ROOM_IDX,	
ssw.WEBSITE_NAME as WEB_CASE_RID, 
case WHEN sse.EVENT_SOURCE ='1' then 'IDC日志'
         WHEN  sse.EVENT_SOURCE ='2' then '其他系统'
        WHEN   sse.EVENT_SOURCE ='3' then '手工添加'
			
	   else 
		    EVENT_SOURCE
	   end  as EVENT_SOURCE,  
sse.REPORT_CITY as REPORT_CITY, 
sse.DOMAIN_NAME  as DOMAIN_NAME,
sse.ip as IP,

case WHEN  sse.THREAT_LEVEL ='0' then '未分级'
		 WHEN sse.THREAT_LEVEL ='1' then '低'
         WHEN  sse.THREAT_LEVEL ='2' then '中'
        WHEN   sse.THREAT_LEVEL ='3' then '高'	
	   else 
		    THREAT_LEVEL
	   end  as THREAT_LEVEL, 	
	   	
case 
		 WHEN sse.THREAT_TYPE1 ='99' then '其它'
         WHEN  sse.THREAT_TYPE1 ='04' then '内部攻击'
        WHEN   sse.THREAT_TYPE1 ='03' then '黑产牟利'	
         WHEN  sse.THREAT_TYPE1 ='02' then '黑客控制'
        WHEN   sse.THREAT_TYPE1 ='01' then '遭受入侵'	
        WHEN   sse.THREAT_TYPE1 ='10' then '挂Q'	
	   else 
		    THREAT_TYPE1
	   end  as THREAT_TYPE1, 
 THREAT_TYPE2,


case WHEN sse.PRIORITY ='1' then '低可疑'
         WHEN  sse.PRIORITY ='2' then '高可疑' 
          WHEN  sse.PRIORITY ='3' then '已失陷' 
	   else 
		    PRIORITY
	   end  as PRIORITY,
case WHEN sse.IS_FORCE_CLOSE ='1' then '是'
         WHEN  sse.IS_FORCE_CLOSE ='2' then '否' 
	   else 
		    IS_FORCE_CLOSE
	   end  as IS_FORCE_CLOSE,
  case WHEN sse.IS_WHITE_LIST ='1' then '是'
         WHEN  sse.IS_WHITE_LIST ='2' then '否' 
	   else 
		    IS_WHITE_LIST
	   end  as IS_WHITE_LIST,

RECTIFY_TERM,
CLOSE_TERM,
SEND_TIME,
case WHEN sse.RECTIFY_STATE ='000' then '未处理'
         WHEN  sse.RECTIFY_STATE ='999' then '未处理'
        WHEN   sse.RECTIFY_STATE ='005' then '未处理'
			WHEN sse.RECTIFY_STATE ='010' then '已下发'
		    WHEN sse.RECTIFY_STATE ='888' then '已关停'
    		WHEN sse.RECTIFY_STATE ='020' then '已关停'
    		WHEN sse.RECTIFY_STATE ='030' then '已关停'
           WHEN sse.RECTIFY_STATE ='900' then '已关停'
           WHEN sse.RECTIFY_STATE ='899' then '已关停'
	   else 
		    RECTIFY_STATE
	   end  as RECTIFY_STATE,

case WHEN sse.RECTIFY_MEASURE ='0' then '未反馈'
         WHEN  sse.RECTIFY_MEASURE ='1' then '已修复'
        WHEN   sse.RECTIFY_MEASURE ='2' then '已关停'
	   else 
		    RECTIFY_MEASURE
	   end  as RECTIFY_MEASURE,
FEEDBACK_TIME,
ENFORCE_COUNT,
ENFORCE_TIME,
RECTIFY_COUNT,
CLOSE_COUNT,
SNAPSHOP,
ENFORCE_USER,
case WHEN sse.MAPPING_MODE ='0' then '未匹配'
         WHEN  sse.MAPPING_MODE ='1' then 'URL匹配'
        WHEN   sse.MAPPING_MODE ='2' then 'IP匹配'
	   else 
		    MAPPING_MODE
	   end  as MAPPING_MODE,
	   
	  case WHEN sse.FINAL_RECTIFY_SUGGEST ='0' then '未知'
         WHEN  sse.FINAL_RECTIFY_SUGGEST ='1' then '整改'
        WHEN   sse.FINAL_RECTIFY_SUGGEST ='2' then '关停'
	   else 
		    FINAL_RECTIFY_SUGGEST
	   end  as FINAL_RECTIFY_SUGGEST,
	   
	   case WHEN sse.THREAT_TYPE4 ='010' then '涉恐'
         WHEN  sse.THREAT_TYPE4 ='020' then '涉政'
        WHEN   sse.THREAT_TYPE4 ='030' then '涉稳'
			WHEN sse.THREAT_TYPE4 ='040' then '涉黄'
		    WHEN sse.THREAT_TYPE4 ='050' then '涉赌'
    		WHEN sse.THREAT_TYPE4 ='060' then '涉毒'
	   else 
		    THREAT_TYPE4
	   end  as THREAT_TYPE4,	
case WHEN sse.EVENT_TYPE1 ='app' then '应用日志'
         WHEN  sse.EVENT_TYPE1 ='url' then 'URL访问日志'
        WHEN   sse.EVENT_TYPE1 ='bbs' then '言论发帖日志'
			WHEN sse.EVENT_TYPE1 ='main' then '	邮件日志'
		    WHEN sse.EVENT_TYPE1 ='vpn' then 'VPN软件'
    		WHEN sse.EVENT_TYPE1 ='vpno' then 'VPN翻墙软件'
	   else 
		    EVENT_TYPE1
	   end  as EVENT_TYPE1,
				
URL,
MEMO
	

	
	   
      from smms_event_main as sse
      left join smms_idc_info as sii
			on sse.ACCESS_ID=sii.IDC_ID
	   left join 
					SMMS_WEB_CASE as ssw
    	on sse.WEB_CASE_RID=ssw.RID
 	where 
	sse.rid=#{RID}
	
	
</select>
<update id="updateDetialCount" parameterType="hashmap">
	update SMMS_EVENT_MAIN set 
	DETIAL_COUNT=#{DETIAL_COUNT},
	MODIFIEDTIME=#{MODIFIEDTIME}
	where RID=#{RID}
</update>
<update id="updateIsForclose" parameterType="hashmap">
	update SMMS_EVENT_MAIN 
	<set>
		<if test="IS_FORCE_CLOSE !=null">IS_FORCE_CLOSE=#{IS_FORCE_CLOSE},</if>
		<if test="PRIORITY !=null">PRIORITY=#{PRIORITY},</if>
		<if test="THREAT_LEVEL !=null">THREAT_LEVEL=#{THREAT_LEVEL},</if>
		<if test="MODIFIEDTIME!=null"> MODIFIEDTIME=#{MODIFIEDTIME},</if> 
		<if test="RECTIFY_STATE!=null"> RECTIFY_STATE=#{RECTIFY_STATE},</if> 
		<if test="FORCE_CLOSE_DESC !=null">FORCE_CLOSE_DESC=#{FORCE_CLOSE_DESC}</if>
	</set>
	where RID=#{RID}
</update>
<update id="updateDetialCountAddOne" parameterType="hashmap">
	update SMMS_EVENT_MAIN set 
	DETIAL_COUNT=DETIAL_COUNT+1
	where RID=#{RID}
</update>

<update id="updateKeyWords" parameterType="hashmap">
	update SMMS_EVENT_MAIN
	 <set> 
		<if test="THREAT_TYPE4!=null">THREAT_TYPE4=#{THREAT_TYPE4},</if>
		<if test="KEYWORDS!=null">KEYWORDS=#{KEYWORDS},</if>
		<if test="THREAT_LEVEL !=null">THREAT_LEVEL=#{THREAT_LEVEL},</if>
		<if test="IS_FORCE_CLOSE !=null">IS_FORCE_CLOSE=#{IS_FORCE_CLOSE},</if>
		<if test="MODIFIEDTIME!=null"> MODIFIEDTIME=#{MODIFIEDTIME},</if> 
		<if test="RECTIFY_STATE!=null"> RECTIFY_STATE=#{RECTIFY_STATE},</if> 
		<if test="FORCE_CLOSE_DESC !=null">FORCE_CLOSE_DESC=#{FORCE_CLOSE_DESC}</if>
	 </set>
	where RID=#{RID}
</update>
<select id="selectDetailRid" parameterType="hashmap" resultType="hashmap">
	select DETAIL_RID,IS_FORCE_CLOSE from SMMS_EVENT_MAIN where RID=#{RID}
</select>

<select id="viewToJson" parameterType="hashmap" resultType="hashmap">
select 
		ssp.url as URL,
		ssp.SNAPSHOP as SNAPSHOP,
		ssp.ACCESS_ID as ACCESS_ID,
		ssp.THREAT_LEVEL as DAMAGE_CLASS,
		swc.SPONSER_CASE_NUM as CASE_ID,
		ssp.RECTIFY_TERM as RECTIFY_TERM,
		ssp.CLOSE_TERM as CLOSE_TERM,
		ssp.rid as EVENT_ID,
		ssp.ENFORCE_COUNT as ENFORCE_COUNT,
		ssp.CLOSE_COUNT as CLOSE_COUNT,
		ssp.DETAIL_RID as DETAIL_RID,
		case when ssp.DOMAIN_NAME is null or ssp.DOMAIN_NAME=''  then ip  ELSE ssp.DOMAIN_NAME end as DOMAIN,
	<if test='DBTYPE=="MYSQL" || DBTYPE=="ORACLE"'>
		CONCAT(CONCAT(CONCAT(CONCAT(ssp.THREAT_TYPE1,'_'),ssp.THREAT_TYPE2),'_',ssp.THREAT_TYPE3),'_',ssp.THREAT_TYPE4) as SECURITY_TYPE 
	</if>	
	<if test='DBTYPE=="POSTGRESQL"'>
		ssp.THREAT_TYPE1 || '_' || ssp.THREAT_TYPE2 || '_' || ssp.THREAT_TYPE3 || '_' || ssp.THREAT_TYPE4  as SECURITY_TYPE
	</if>		
		
from SMMS_EVENT_MAIN as ssp 
left JOIN
		smms_web_case as swc 
on 
ssp.WEB_CASE_RID=swc.rid 
<where>
		ssp.RECORDSTATE='0'
		and ssp.ACCESS_ID !='' and ssp.ACCESS_ID is not null 
        <if test="RIDCONDITION !=null and RIDCONDITION!='' ">   
             ${RIDCONDITION}
        </if>	
</where>
 
</select>
<select id="viewToRectify" parameterType="hashmap" resultType="hashmap">
	select 
	ssp.rid as EVENT_ID,
	ssp.url as URL,
	ssp.ENFORCE_COUNT as ENFORCE_COUNT,
	ssp.DETAIL_RID as DETAIL_RID,
	case when ssp.DOMAIN_NAME is null or ssp.DOMAIN_NAME=''  then ip  ELSE ssp.DOMAIN_NAME end as DOMAIN,
	<if test='DBTYPE=="MYSQL" || DBTYPE=="ORACLE"'>
		CONCAT(CONCAT(CONCAT(CONCAT(ssp.THREAT_TYPE1,'_'),ssp.THREAT_TYPE2),'_',ssp.THREAT_TYPE3),'_',ssp.THREAT_TYPE4) as SECURITY_TYPE,
	</if>	
	<if test='DBTYPE=="POSTGRESQL"'>
		ssp.THREAT_TYPE1 || '_' || ssp.THREAT_TYPE2 || '_' || ssp.THREAT_TYPE3 || '_' || ssp.THREAT_TYPE4 as SECURITY_TYPE,
	</if>	
	
	ssp.THREAT_LEVEL as DAMAGE_CLASS,
	ssp.ACCESS_ID as ACCESS_ID,
	ssp.FINAL_RECTIFY_SUGGEST as RECTIFY_SUGGEST,
	ssp.RECTIFY_TERM as RECTIFY_TERM,
	swc.SPONSER_CASE_NUM as CASE_ID,
	ssp.SNAPSHOP as SNAPSHOP
from SMMS_EVENT_MAIN as ssp 
left JOIN
		smms_web_case as swc 
on 
ssp.WEB_CASE_RID=swc.rid 
<where>
		 ssp.RECORDSTATE='0'
		 and ssp.ACCESS_ID !='' and ssp.ACCESS_ID is not null 
        <if test="RIDCONDITION!=null and RIDCONDITION!='' ">   
             ${RIDCONDITION}
        </if>	
</where>

</select>
<select id="viewToAllRectify" parameterType="hashmap" resultType="hashmap">
	select 
	ssp.rid as EVENT_ID,
	ssp.url as URL,
	ssp.ENFORCE_COUNT as ENFORCE_COUNT,
	ssp.DETAIL_RID as DETAIL_RID,
	case when ssp.DOMAIN_NAME is null or ssp.DOMAIN_NAME=''  then ip  ELSE ssp.DOMAIN_NAME end as DOMAIN,
	<if test='DBTYPE=="MYSQL" || DBTYPE=="ORACLE"'>
		CONCAT(CONCAT(CONCAT(CONCAT(ssp.THREAT_TYPE1,'_'),ssp.THREAT_TYPE2),'_',ssp.THREAT_TYPE3),'_',ssp.THREAT_TYPE4) as SECURITY_TYPE,
	</if>	
	<if test='DBTYPE=="POSTGRESQL"'>
		ssp.THREAT_TYPE1 || '_' || ssp.THREAT_TYPE2 || '_' || ssp.THREAT_TYPE3 || '_' || ssp.THREAT_TYPE4 as SECURITY_TYPE,
	</if>	
	
	ssp.THREAT_LEVEL as DAMAGE_CLASS,
	ssp.ACCESS_ID as ACCESS_ID,
	ssp.FINAL_RECTIFY_SUGGEST as RECTIFY_SUGGEST,
	ssp.RECTIFY_TERM as RECTIFY_TERM,
	swc.SPONSER_CASE_NUM as CASE_ID,
	ssp.SNAPSHOP as SNAPSHOP
from SMMS_EVENT_MAIN as ssp 
left JOIN
		smms_web_case as swc 
on 
ssp.WEB_CASE_RID=swc.rid 
where 
		ssp.RECTIFY_STATE='000' 
and ssp.IS_FORCE_CLOSE='2' and ssp.RECORDSTATE='0' and ssp.ACCESS_ID !='' and ssp.ACCESS_ID is not null 
order by ssp.access_id asc
</select>
<select id="viewToAllJson" parameterType="hashmap" resultType="hashmap">
select 
	    ssp.url as URL,
	    ssp.SNAPSHOP as SNAPSHOP,
		ssp.ACCESS_ID as ACCESS_ID,
		ssp.THREAT_LEVEL as DAMAGE_CLASS,
		swc.SPONSER_CASE_NUM as CASE_ID,
		ssp.RECTIFY_TERM as RECTIFY_TERM,
		ssp.CLOSE_TERM as CLOSE_TERM,
		ssp.rid as EVENT_ID,
		ssp.ENFORCE_COUNT as ENFORCE_COUNT,
		ssp.CLOSE_COUNT as CLOSE_COUNT,
		ssp.DETAIL_RID as DETAIL_RID,
		case when ssp.DOMAIN_NAME is null or ssp.DOMAIN_NAME=''  then ip  ELSE ssp.DOMAIN_NAME end as DOMAIN,
	<if test='DBTYPE=="MYSQL" || DBTYPE=="ORACLE"'>
		CONCAT(CONCAT(CONCAT(CONCAT(ssp.THREAT_TYPE1,'_'),ssp.THREAT_TYPE2),'_',ssp.THREAT_TYPE3),'_',ssp.THREAT_TYPE4) as SECURITY_TYPE 
	</if>	
	<if test='DBTYPE=="POSTGRESQL"'>
		ssp.THREAT_TYPE1 || '_' || ssp.THREAT_TYPE2 || '_' || ssp.THREAT_TYPE3 || '_' || ssp.THREAT_TYPE4  as SECURITY_TYPE
	</if>				
		
from SMMS_EVENT_MAIN as ssp 
left JOIN
		smms_web_case as swc 
on 
		ssp.WEB_CASE_RID=swc.rid 
where 
		ssp.RECTIFY_STATE='000' 
and ssp.IS_FORCE_CLOSE='1' and ssp.RECORDSTATE='0' and ssp.ACCESS_ID !='' and ssp.ACCESS_ID is not null
order by ssp.access_id asc
</select>

<select id="viewToAllJsonIp" parameterType="hashmap" resultType="hashmap">
select 
	ssi.ACCESS_IP as IP,
	ssp.ENFORCE_COUNT as ENFORCE_COUNT,
	ssp.CLOSE_COUNT as CLOSE_COUNT,
	ssp.DETAIL_RID as DETAIL_RID,
	ssp.DOMAIN_NAME as DOMAIN
from SMMS_EVENT_MAIN as ssp 
left JOIN
		smms_web_case as swc 
on 
		ssp.WEB_CASE_RID=swc.rid 
left join 
	smms_web_case_ip as ssi
on 
	swc.rid=ssi.case_rid
where 
		 ssp.IS_FORCE_CLOSE='1' and ssp.RECORDSTATE='0'
order by ssp.access_id asc
</select>
<select id="viewToJsonIp" parameterType="hashmap" resultType="hashmap">
select 
	ssp.RID as EVENT_RID,
	ssp.ENFORCE_COUNT as ENFORCE_COUNT,
	ssp.CLOSE_COUNT as CLOSE_COUNT,
	ssp.DETAIL_RID as DETAIL_RID,
	case when ssp.DOMAIN_NAME is null or ssp.DOMAIN_NAME=''  then ip  ELSE ssp.DOMAIN_NAME end as DOMAIN
from SMMS_EVENT_MAIN as ssp 
<where>
		 ssp.RECORDSTATE='0'
        <if test="RIDCONDITION!=null and RIDCONDITION!='' ">   
             ${RIDCONDITION}
        </if>	
</where>
</select>
<select id="viewAllMappingMode" parameterType="hashmap" resultType="hashmap">
select 
	MAPPING_MODE
from SMMS_EVENT_MAIN as ssp 
left JOIN
		smms_web_case as swc 
on 
		ssp.WEB_CASE_RID=swc.rid 
where 
		ssp.RECTIFY_STATE='000' 
and ssp.IS_FORCE_CLOSE='1' and ssp.RECORDSTATE='0'

</select>
<select id="checkAccessIdAndRoomIdx" parameterType="hashmap" resultType="hashmap">
		SELECT 
			sii.rid as SIIRID,
			sii.IDC_NAME as IDC_NAME,
			ssr.rid as SSRRID,
			ssr.ROOM_NAME as ROOM_NAME,
			ssr.ROOM_IDX as ROOM_IDX,
			ssr.ROOM_ADDRESS as ROOM_ADDRESS
		FROM 
	
			smms_room_info as ssr
	left join
			smms_idc_info as sii
		on 
		ssr.ACCESS_ID=sii.IDC_ID	
	where 
		ssr.ACCESS_ID=#{ACCESS_ID}
	and 
		ssr.ROOM_IDX=#{ROOM_IDX}
	and
		 ssr.RECORDSTATE='0'
</select>



<update id="stateUpdate" parameterType="hashmap">
	update SMMS_EVENT_MAIN set 
	RECTIFY_MEASURE=#{RECTIFY_MEASURE},
	RECTIFY_STATE=#{RECTIFY_STATE},
	FEEDBACK_TIME=#{FEEDBACK_TIME},
	FEEDBACK_TIMESTAMP=#{FEEDBACK_TIMESTAMP},
	ENFORCE_COUNT=ENFORCE_COUNT+1,
	RECTIFY_COUNT=RECTIFY_COUNT+1,
	MODIFIEDTIME=#{MODIFIEDTIME}
	where RID=#{RID}
</update>
<update id="stateUpdateForClose" parameterType="hashmap">
	update SMMS_EVENT_MAIN set 
	RECTIFY_MEASURE=#{RECTIFY_MEASURE},
	RECTIFY_STATE=#{RECTIFY_STATE},
	FEEDBACK_TIME=#{FEEDBACK_TIME},
	FEEDBACK_TIMESTAMP=#{FEEDBACK_TIMESTAMP},
	ENFORCE_COUNT=ENFORCE_COUNT+1,
	CLOSE_COUNT=CLOSE_COUNT+1,
	MODIFIEDTIME=#{MODIFIEDTIME}
	where RID=#{RID}
</update>
<update id="issueStateUpdate" parameterType="hashmap">
UPDATE SMMS_EVENT_MAIN
		<set>
		    <if test="RECTIFY_STATE!=null"> RECTIFY_STATE=#{RECTIFY_STATE},</if> 
		    <if test="SEND_TIME!=null"> SEND_TIME=#{SEND_TIME},</if> 
		    <if test="SEND_TIMESTAMP!=null"> SEND_TIMESTAMP=#{SEND_TIMESTAMP},</if> 
		    <if test="MODIFIEDTIME!=null"> MODIFIEDTIME=#{MODIFIEDTIME}</if> 
		</set>
WHERE RID =#{EVENT_ID} and RECTIFY_STATE='000' and IS_FORCE_CLOSE='2' 'and RECORDSTATE='0';
</update>

<update id="updateReStateAfter" parameterType="hashmap" > 
	update SMMS_EVENT_MAIN   
		<set>
		    <if test="RECTIFY_STATE!=null"> RECTIFY_STATE=#{RECTIFY_STATE},</if> 
		    <if test="MODIFIEDTIME!=null"> MODIFIEDTIME=#{MODIFIEDTIME}</if> 
		</set>
	where RID=#{RID} 
</update>
<update id="updateCloseReStateAfter" parameterType="hashmap" > 
	update SMMS_EVENT_MAIN   
		<set>
		    <if test="RECTIFY_STATE!=null"> RECTIFY_STATE=#{RECTIFY_STATE},</if> 
		    <if test="SYS_RECTIFY_SUGGEST != null ">SYS_RECTIFY_SUGGEST=#{SYS_RECTIFY_SUGGEST},</if>
            <if test="FINAL_RECTIFY_SUGGEST != null ">FINAL_RECTIFY_SUGGEST=#{FINAL_RECTIFY_SUGGEST},</if>
            <if test="IS_FORCE_CLOSE != null ">IS_FORCE_CLOSE=#{IS_FORCE_CLOSE},</if>
		    <if test="MODIFIEDTIME!=null"> MODIFIEDTIME=#{MODIFIEDTIME}</if> 
		</set>
	where RID=#{RID}   and RECORDSTATE='0'
</update>
<update id="updateRectifyState" parameterType="hashmap" > 
	update SMMS_EVENT_MAIN   
		<set>
		    <if test="RECTIFY_STATE!=null"> RECTIFY_STATE=#{RECTIFY_STATE},</if> 
		    <if test="SEND_TIME!=null"> SEND_TIME=#{SEND_TIME},</if> 
		    <if test="SEND_TIMESTAMP!=null"> SEND_TIMESTAMP=#{SEND_TIMESTAMP},</if> 
		    <if test="ENFORCE_COUNT!=null"> ENFORCE_COUNT=#{ENFORCE_COUNT},</if> 
		    <if test="ENFORCE_TIME != null ">ENFORCE_TIME=#{ENFORCE_TIME},</if>
            <if test="ENFORCE_USER != null ">ENFORCE_USER=#{ENFORCE_USER},</if>
		    <if test="MODIFIEDTIME!=null"> MODIFIEDTIME=#{MODIFIEDTIME}</if> 
		</set>
	where RID=#{EVENT_RID}   and RECORDSTATE='0';
</update>
<update id="updateQzgtState" parameterType="hashmap" > 
	update SMMS_EVENT_MAIN   
		<set>
		    <if test="RECTIFY_STATE !=null"> RECTIFY_STATE=#{RECTIFY_STATE},</if> 
		    <if test="SEND_TIME !=null"> SEND_TIME=#{SEND_TIME},</if> 
		    <if test="SEND_TIMESTAMP !=null"> SEND_TIMESTAMP=#{SEND_TIMESTAMP},</if> 
		    <if test="ENFORCE_COUNT !=null"> ENFORCE_COUNT=#{ENFORCE_COUNT},</if> 
		    <if test="ENFORCE_TIME != null ">ENFORCE_TIME=#{ENFORCE_TIME},</if>
            <if test="ENFORCE_USER != null ">ENFORCE_USER=#{ENFORCE_USER},</if>
            <if test="CLOSE_COUNT != null ">CLOSE_COUNT=#{CLOSE_COUNT},</if>
		    <if test="MODIFIEDTIME!=null"> MODIFIEDTIME=#{MODIFIEDTIME}</if> 
		</set>
	where RID=#{EVENT_RID}   and RECORDSTATE='0' 
</update>

<!-- 统计地市IDC安全信息分类 -->
<!-- 未备案未处理 -->
<select id="getCountWebCaseRidNull" parameterType="hashmap" resultType="hashmap"> 
	select ACCESS_ID as IDC_ID, count(*) as WBA from smms_event_main 
	       where 
	            RECORDSTATE='0' and RECTIFY_STATE='000' 
	       		and (WEB_CASE_RID is null or WEB_CASE_RID='')	
           		and ACCESS_ID is not null and ACCESS_ID!=''	
           		GROUP BY ACCESS_ID 
           		ORDER BY ACCESS_ID DESC
</select> 
<!-- 010 涉恐    020涉政    030 涉稳    040 涉黄 050涉赌  060涉毒 -->
<select id="getCountThreatType4Sk" parameterType="hashmap" resultType="hashmap"> 
	select ACCESS_ID as IDC_ID,count(*) as SS1_SK from smms_event_main 
 where 
  threat_type4 like '%010%' 
  and  RECORDSTATE='0' 
  and RECTIFY_STATE='000'
  and (threat_type4!='' or threat_type4 is not null)
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>
<select id="getCountThreatType4Sz" parameterType="hashmap" resultType="hashmap"> 
	select ACCESS_ID as IDC_ID,count(*) as SS1_SZ from smms_event_main 
 where 
  threat_type4 like '%020%' 
  and  RECORDSTATE='0' 
  and RECTIFY_STATE='000'
  and (threat_type4!='' or threat_type4 is not null)
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>
<select id="getCountThreatType4Sw" parameterType="hashmap" resultType="hashmap"> 
	select ACCESS_ID as IDC_ID,count(*) as SS1_SW from smms_event_main 
 where 
  threat_type4 like '%030%' 
  and  RECORDSTATE='0' 
  and RECTIFY_STATE='000'
  and (threat_type4!='' or threat_type4 is not null)
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>

<select id="getCountThreatType4Sh" parameterType="hashmap" resultType="hashmap"> 
	select ACCESS_ID as IDC_ID,count(*) as SS2_SH from smms_event_main 
 where 
  threat_type4 like '%040%' 
  and  RECORDSTATE='0' 
  and RECTIFY_STATE='000'
  and (threat_type4!='' or threat_type4 is not null)
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>

<select id="getCountThreatType4Sd" parameterType="hashmap" resultType="hashmap"> 
	select ACCESS_ID as IDC_ID,count(*) as SS2_SD from smms_event_main 
 where 
  threat_type4 like '%050%' 
  and  RECORDSTATE='0' 
  and RECTIFY_STATE='000'
  and (threat_type4!='' or threat_type4 is not null)
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>
<select id="getCountThreatType4Sdu" parameterType="hashmap" resultType="hashmap"> 
	select ACCESS_ID as IDC_ID,count(*) as SS2_SDU from smms_event_main 
 where 
  threat_type4 like '%060%' 
  and  RECORDSTATE='0' 
  and RECTIFY_STATE='000'
  and (threat_type4!='' or threat_type4 is not null)
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>

<select id="getCountThreatType4One" parameterType="hashmap" resultType="hashmap"> 
	select ACCESS_ID as IDC_ID,count(*) as SS1 from smms_event_main 
 where 
    (threat_type4 like '%010%' 
    or
    threat_type4 like '%020%' 
  or
  threat_type4 like '%030%' 
    )
  and  RECORDSTATE='0' 
  and RECTIFY_STATE='000'
  and threat_type4!='' and threat_type4 is not null
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>


<select id="getCountThreatType4Two" parameterType="hashmap" resultType="hashmap"> 
select ACCESS_ID as IDC_ID,count(*) as SS2 from smms_event_main 
 where 
    (threat_type4 like '%040%' 
  or
    threat_type4 like '%050%' 
  or
  threat_type4 like '%060%' 
    )
  and  RECORDSTATE='0' 
  and RECTIFY_STATE='000'
  and threat_type4!='' and threat_type4 is not null
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>
<!-- 翻墙代理 -->
<select id="getCountEventType1Vpno" parameterType="hashmap" resultType="hashmap"> 
select ACCESS_ID as IDC_ID,count(*) as FQDL  from smms_event_main where RECORDSTATE='0' and EVENT_TYPE1='vpno' and RECTIFY_STATE='000' 	and ACCESS_ID is not null and ACCESS_ID!=''	
GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>

<select id="getCountZSRQ" parameterType="hashmap" resultType="hashmap"> 
select ACCESS_ID as IDC_ID,count(*) as ZSRQ  from smms_event_main where RECORDSTATE='0' and THREAT_TYPE1='01'  and RECTIFY_STATE='000'	and ACCESS_ID is not null and ACCESS_ID!=''	
GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>

<select id="getCountHCML" parameterType="hashmap" resultType="hashmap"> 
select ACCESS_ID as IDC_ID,count(*) as HCML  from smms_event_main where RECORDSTATE='0' and THREAT_TYPE1='03'  and RECTIFY_STATE='000' 	and ACCESS_ID is not null and ACCESS_ID!=''	
GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>

<select id="getCountHKKZ" parameterType="hashmap" resultType="hashmap"> 
select ACCESS_ID as IDC_ID,count(*) as HKKZ  from smms_event_main where RECORDSTATE='0' and THREAT_TYPE1='02'  and RECTIFY_STATE='000' 	and ACCESS_ID is not null and ACCESS_ID!=''	
GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>

<select id="getCountNBGJ" parameterType="hashmap" resultType="hashmap"> 
select ACCESS_ID as IDC_ID,count(*) as NBGJ  from smms_event_main where RECORDSTATE='0' and THREAT_TYPE1='04'  and RECTIFY_STATE='000' 	and ACCESS_ID is not null and ACCESS_ID!=''	
GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>


<!-- 未备案处理中 -->
<select id="getCountWebCaseRidNullCLZ" parameterType="hashmap" resultType="hashmap"> 
select ACCESS_ID as IDC_ID,count(*) as WBA_CLZ from smms_event_main where RECORDSTATE='0' and (RECTIFY_STATE='010' or RECTIFY_STATE='999' or RECTIFY_STATE='005') and (WEB_CASE_RID is null or WEB_CASE_RID='')	and ACCESS_ID is not null and ACCESS_ID!=''	
GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select> 

<select id="getCountThreatType4SkCLZ" parameterType="hashmap" resultType="hashmap"> 
	select ACCESS_ID as IDC_ID,count(*) as SS1_SK_CLZ from smms_event_main 
 where 
  threat_type4 like '%010%' 
  and  RECORDSTATE='0' 
  and (RECTIFY_STATE='010' or RECTIFY_STATE='999' or RECTIFY_STATE='005')
  and (threat_type4!='' or threat_type4 is not null)
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>
<select id="getCountThreatType4SzCLZ" parameterType="hashmap" resultType="hashmap"> 
	select ACCESS_ID as IDC_ID,count(*) as SS1_SZ_CLZ from smms_event_main 
 where 
  threat_type4 like '%020%' 
  and  RECORDSTATE='0' 
  and (RECTIFY_STATE='010' or RECTIFY_STATE='999' or RECTIFY_STATE='005')
  and (threat_type4!='' or threat_type4 is not null)
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>
<select id="getCountThreatType4SwCLZ" parameterType="hashmap" resultType="hashmap"> 
	select ACCESS_ID as IDC_ID,count(*) as SS1_SW_CLZ from smms_event_main 
 where 
  threat_type4 like '%030%' 
  and  RECORDSTATE='0' 
  and (RECTIFY_STATE='010' or RECTIFY_STATE='999' or RECTIFY_STATE='005')
  and (threat_type4!='' or threat_type4 is not null)
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>

<select id="getCountThreatType4ShCLZ" parameterType="hashmap" resultType="hashmap"> 
	select ACCESS_ID as IDC_ID,count(*) as SS2_SH_CLZ from smms_event_main 
 where 
  threat_type4 like '%040%' 
  and  RECORDSTATE='0' 
  and (RECTIFY_STATE='010' or RECTIFY_STATE='999' or RECTIFY_STATE='005')
  and (threat_type4!='' or threat_type4 is not null)
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>

<select id="getCountThreatType4SdCLZ" parameterType="hashmap" resultType="hashmap"> 
	select ACCESS_ID as IDC_ID,count(*) as SS2_SD_CLZ from smms_event_main 
 where 
  threat_type4 like '%050%' 
  and  RECORDSTATE='0' 
  and (RECTIFY_STATE='010' or RECTIFY_STATE='999' or RECTIFY_STATE='005')
  and (threat_type4!='' or threat_type4 is not null)
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>
<select id="getCountThreatType4SduCLZ" parameterType="hashmap" resultType="hashmap"> 
	select ACCESS_ID as IDC_ID,count(*) as SS2_SDU_CLZ from smms_event_main 
 where 
  threat_type4 like '%060%' 
  and  RECORDSTATE='0' 
  and (RECTIFY_STATE='010' or RECTIFY_STATE='999' or RECTIFY_STATE='005')
  and (threat_type4!='' or threat_type4 is not null)
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>


<select id="getCountThreatType4OneCLZ" parameterType="hashmap" resultType="hashmap"> 
	select ACCESS_ID as IDC_ID,count(*) as SS1_CLZ from smms_event_main 
 where 
    (threat_type4 like '%010%' 
    or
    threat_type4 like '%020%' 
  or
  threat_type4 like '%030%' 
    )
  and  RECORDSTATE='0' 
  and (RECTIFY_STATE='010' or RECTIFY_STATE='999' or RECTIFY_STATE='005')
  and (threat_type4!='' or threat_type4 is not null)
  and (WEB_CASE_RID is null or WEB_CASE_RID='')	
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>


<select id="getCountThreatType4TwoCLZ" parameterType="hashmap" resultType="hashmap"> 
select ACCESS_ID as IDC_ID,count(*) as SS2_CLZ from smms_event_main 
 where 
    (threat_type4 like '%040%' 
  or
    threat_type4 like '%050%' 
  or
  threat_type4 like '%060%' 
    )
  and  RECORDSTATE='0' 
  and (RECTIFY_STATE='010' or RECTIFY_STATE='999' or RECTIFY_STATE='005')
  and (threat_type4!='' or threat_type4 is not null)
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>

<select id="getCountEventType1VpnoCLZ" parameterType="hashmap" resultType="hashmap"> 
select ACCESS_ID as IDC_ID,count(*) as FQDL_CLZ  from smms_event_main where RECORDSTATE='0' and EVENT_TYPE1='vpno' and (RECTIFY_STATE='010' or RECTIFY_STATE='999' or RECTIFY_STATE='005') 	and ACCESS_ID is not null and ACCESS_ID!=''	
GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>

<select id="getCountZSRQCLZ" parameterType="hashmap" resultType="hashmap"> 
select ACCESS_ID as IDC_ID,count(*) as ZSRQ_CLZ  from smms_event_main where RECORDSTATE='0' and THREAT_TYPE1='01'  and (RECTIFY_STATE='010' or RECTIFY_STATE='999' or RECTIFY_STATE='005')	and ACCESS_ID is not null and ACCESS_ID!=''	
GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>

<select id="getCountHCMLCLZ" parameterType="hashmap" resultType="hashmap"> 
select ACCESS_ID as IDC_ID,count(*) as HCML_CLZ  from smms_event_main where RECORDSTATE='0' and THREAT_TYPE1='03'  and (RECTIFY_STATE='010' or RECTIFY_STATE='999' or RECTIFY_STATE='005') 	and ACCESS_ID is not null and ACCESS_ID!=''	
GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>

<select id="getCountHKKZCLZ" parameterType="hashmap" resultType="hashmap"> 
select ACCESS_ID as IDC_ID,count(*) as HKKZ_CLZ  from smms_event_main where RECORDSTATE='0' and THREAT_TYPE1='02'  and (RECTIFY_STATE='010' or RECTIFY_STATE='999' or RECTIFY_STATE='005') 	and ACCESS_ID is not null and ACCESS_ID!=''	
GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>

<select id="getCountNBGJCLZ" parameterType="hashmap" resultType="hashmap"> 
select ACCESS_ID as IDC_ID,count(*) as NBGJ_CLZ from smms_event_main where RECORDSTATE='0' and THREAT_TYPE1='04'  and (RECTIFY_STATE='010' or RECTIFY_STATE='999' or RECTIFY_STATE='005')	and ACCESS_ID is not null and ACCESS_ID!=''	
GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>


<!-- 未备案已处理 -->
<select id="getCountWebCaseRidNullYCL" parameterType="hashmap" resultType="hashmap"> 
select ACCESS_ID as IDC_ID,count(*) as WBA_YCL from smms_event_main where RECORDSTATE='0' and (RECTIFY_STATE='888' or RECTIFY_STATE='020' or RECTIFY_STATE='030' or RECTIFY_STATE='899' or RECTIFY_STATE='900') and (WEB_CASE_RID is null or WEB_CASE_RID='')	and ACCESS_ID is not null and ACCESS_ID!=''	
GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select> 

<select id="getCountThreatType4SkYCL" parameterType="hashmap" resultType="hashmap"> 
	select ACCESS_ID as IDC_ID,count(*) as SS1_SK_YCL from smms_event_main 
 where 
  threat_type4 like '%010%' 
  and  RECORDSTATE='0' 
  and (RECTIFY_STATE='888' or RECTIFY_STATE='899' or RECTIFY_STATE='020' or RECTIFY_STATE='030' or RECTIFY_STATE='900')
  and (threat_type4!='' or threat_type4 is not null)
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>
<select id="getCountThreatType4SzYCL" parameterType="hashmap" resultType="hashmap"> 
	select ACCESS_ID as IDC_ID,count(*) as SS1_SZ_YCL from smms_event_main 
 where 
  threat_type4 like '%020%' 
  and  RECORDSTATE='0' 
  and (RECTIFY_STATE='888' or RECTIFY_STATE='899' or RECTIFY_STATE='020' or RECTIFY_STATE='030' or RECTIFY_STATE='900')
  and (threat_type4!='' or threat_type4 is not null)
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>
<select id="getCountThreatType4SwYCL" parameterType="hashmap" resultType="hashmap"> 
	select ACCESS_ID as IDC_ID,count(*) as SS1_SW_YCL from smms_event_main 
 where 
  threat_type4 like '%030%' 
  and  RECORDSTATE='0' 
  and (RECTIFY_STATE='888' or RECTIFY_STATE='899' or RECTIFY_STATE='020' or RECTIFY_STATE='030' or RECTIFY_STATE='900')
  and (threat_type4!='' or threat_type4 is not null)
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>

<select id="getCountThreatType4ShYCL" parameterType="hashmap" resultType="hashmap"> 
	select ACCESS_ID as IDC_ID,count(*) as SS2_SH_YCL from smms_event_main 
 where 
  threat_type4 like '%040%' 
  and  RECORDSTATE='0' 
  and (RECTIFY_STATE='888' or RECTIFY_STATE='899' or RECTIFY_STATE='020' or RECTIFY_STATE='030' or RECTIFY_STATE='900')
  and (threat_type4!='' or threat_type4 is not null)
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>

<select id="getCountThreatType4SdYCL" parameterType="hashmap" resultType="hashmap"> 
	select ACCESS_ID as IDC_ID,count(*) as SS2_SD_YCL from smms_event_main 
 where 
  threat_type4 like '%050%' 
  and  RECORDSTATE='0' 
  and (RECTIFY_STATE='888' or RECTIFY_STATE='899' or RECTIFY_STATE='020' or RECTIFY_STATE='030' or RECTIFY_STATE='900')
  and (threat_type4!='' or threat_type4 is not null)
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>
<select id="getCountThreatType4SduYCL" parameterType="hashmap" resultType="hashmap"> 
	select ACCESS_ID as IDC_ID,count(*) as SS2_SDU_YCL from smms_event_main 
 where 
  threat_type4 like '%060%' 
  and  RECORDSTATE='0' 
  and (RECTIFY_STATE='888' or RECTIFY_STATE='899' or RECTIFY_STATE='020' or RECTIFY_STATE='030' or RECTIFY_STATE='900')
  and (threat_type4!='' or threat_type4 is not null)
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>

<select id="getCountThreatType4OneYCL" parameterType="hashmap" resultType="hashmap"> 
	select ACCESS_ID as IDC_ID,count(*) as SS1_YCL from smms_event_main 
 where 
    (threat_type4 like '%010%' 
    or
    threat_type4 like '%020%' 
  or
  threat_type4 like '%030%' 
    )
  and  RECORDSTATE='0' 
  and (RECTIFY_STATE='888' or RECTIFY_STATE='899' or RECTIFY_STATE='020' or RECTIFY_STATE='030' or RECTIFY_STATE='900')
  and (threat_type4!='' or threat_type4 is not null)
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>


<select id="getCountThreatType4TwoYCL" parameterType="hashmap" resultType="hashmap"> 
select ACCESS_ID as IDC_ID,count(*) as SS2_YCL from smms_event_main 
 where 
    (threat_type4 like '%040%' 
  or
    threat_type4 like '%050%' 
  or
  threat_type4 like '%060%' 
    )
  and  RECORDSTATE='0' 
  and (RECTIFY_STATE='888' or RECTIFY_STATE='899' or RECTIFY_STATE='020' or RECTIFY_STATE='030' or RECTIFY_STATE='900')
  and (threat_type4!='' or threat_type4 is not null)
  and ACCESS_ID is not null and ACCESS_ID!=''	
  GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>

<select id="getCountEventType1VpnoYCL" parameterType="hashmap" resultType="hashmap"> 
select ACCESS_ID as IDC_ID,count(*) as FQDL_YCL  from smms_event_main where RECORDSTATE='0' and EVENT_TYPE1='vpno' and (RECTIFY_STATE='888' or RECTIFY_STATE='899' or RECTIFY_STATE='020' or RECTIFY_STATE='030' or RECTIFY_STATE='900') and ACCESS_ID is not null and ACCESS_ID!=''	
GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>

<select id="getCountZSRQYCL" parameterType="hashmap" resultType="hashmap"> 
select ACCESS_ID as IDC_ID,count(*) as ZSRQ_YCL  from smms_event_main where RECORDSTATE='0' and THREAT_TYPE1='01'  and (RECTIFY_STATE='888' or RECTIFY_STATE='899' or RECTIFY_STATE='020' or RECTIFY_STATE='030' or RECTIFY_STATE='900') 	and ACCESS_ID is not null and ACCESS_ID!=''	
GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>

<select id="getCountHCMLYCL" parameterType="hashmap" resultType="hashmap"> 
select ACCESS_ID as IDC_ID,count(*) as HCML_YCL  from smms_event_main where RECORDSTATE='0' and THREAT_TYPE1='03'  and (RECTIFY_STATE='888' or RECTIFY_STATE='899' or RECTIFY_STATE='020' or RECTIFY_STATE='030' or RECTIFY_STATE='900') 	and ACCESS_ID is not null and ACCESS_ID!=''	
GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>

<select id="getCountHKKZYCL" parameterType="hashmap" resultType="hashmap"> 
select ACCESS_ID as IDC_ID,count(*) as HKKZ_YCL  from smms_event_main where RECORDSTATE='0' and THREAT_TYPE1='02'  and (RECTIFY_STATE='888' or RECTIFY_STATE='899' or RECTIFY_STATE='020' or RECTIFY_STATE='030' or RECTIFY_STATE='900') 	and ACCESS_ID is not null and ACCESS_ID!=''	
GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>

<select id="getCountNBGJYCL" parameterType="hashmap" resultType="hashmap"> 
select ACCESS_ID as IDC_ID,count(*) as NBGJ_YCL  from smms_event_main where RECORDSTATE='0' and THREAT_TYPE1='04'  and (RECTIFY_STATE='888' or RECTIFY_STATE='899' or RECTIFY_STATE='020' or RECTIFY_STATE='030' or RECTIFY_STATE='900') 	and ACCESS_ID is not null and ACCESS_ID!=''	
GROUP BY ACCESS_ID ORDER BY ACCESS_ID DESC
</select>

<!-- 关停业务恢复申请 -->
<select id="getCountGtz" parameterType="hashmap" resultType="hashmap"> 
select count(*) as GTZ,ACCESS_ID as IDC_ID ,ROOM_IDX from smms_event_main where 
IS_FORCE_CLOSE='1' and RECORDSTATE='0' 
and (RECTIFY_STATE='010' or RECTIFY_STATE='999' or RECTIFY_STATE='005') 	
and ACCESS_ID is not null and ACCESS_ID!=''	
GROUP BY ACCESS_ID ,ROOM_IDX 
ORDER BY ACCESS_ID DESC
</select>

<select id="getCountSqhf" parameterType="hashmap" resultType="hashmap"> 
select count(*) as SQHF,ACCESS_ID as IDC_ID ,ROOM_IDX from smms_event_main where 
IS_FORCE_CLOSE='1' and RECORDSTATE='0' 
and RECTIFY_STATE='030'
and ACCESS_ID is not null and ACCESS_ID!=''	
GROUP BY ACCESS_ID ,ROOM_IDX
ORDER BY ACCESS_ID DESC
</select>
<!-- 整改处理 -->
<!-- 待整改 -->
<select id="getCountDzg" parameterType="hashmap" resultType="hashmap"> 
select count(*) as DZG,ACCESS_ID as IDC_ID,ROOM_IDX from smms_event_main 
where 
IS_FORCE_CLOSE='2' and RECORDSTATE='0' 
and RECTIFY_STATE='000' 
and ACCESS_ID is not null and ACCESS_ID!=''	
and ROOM_IDX is not null and ROOM_IDX!=''
GROUP BY ACCESS_ID ,ROOM_IDX 
ORDER BY ACCESS_ID DESC
</select>
<!-- 整改中 -->
<select id="getCountZgz" parameterType="hashmap" resultType="hashmap"> 
select count(*) as ZGZ,ACCESS_ID as IDC_ID,ROOM_IDX from smms_event_main 
where 
IS_FORCE_CLOSE='2' and RECORDSTATE='0' 
and (RECTIFY_STATE='010' or RECTIFY_STATE='999') 
and ACCESS_ID is not null and ACCESS_ID!=''	
and ROOM_IDX is not null and ROOM_IDX!=''
GROUP BY ACCESS_ID ,ROOM_IDX 
ORDER BY ACCESS_ID DESC
</select>
<!-- 已整改 -->
<select id="getCountYzg" parameterType="hashmap" resultType="hashmap"> 
select count(*) as YZG,ACCESS_ID as IDC_ID,ROOM_IDX from smms_event_main 
where 
IS_FORCE_CLOSE='2' and RECORDSTATE='0' 
and (RECTIFY_STATE='888' or RECTIFY_STATE='020') 
and ACCESS_ID is not null and ACCESS_ID!=''	
and ROOM_IDX is not null and ROOM_IDX!=''
GROUP BY ACCESS_ID ,ROOM_IDX 
ORDER BY ACCESS_ID DESC
</select>
<!-- 风险服务器 -->

<select id="getCountFxFwq" parameterType="hashmap" resultType="hashmap"> 
select sse.THREAT_TYPE2  as THREAT_TYPE2,
				sse.room_name as ROOM_NAME,
				sii.idc_short_name as IDC_NAME,
				IP,
case WHEN sse.PRIORITY='3' then '已失陷'
	   else 
		    RECTIFY_STATE
	   end  as RECTIFY_STATE
      from smms_event_main as sse
      left join smms_idc_info as sii
			on sse.ACCESS_ID=sii.IDC_ID
	   
 	where 
PRIORITY='3'
	and 
	sse.RECORDSTATE='0' and sse.ACCESS_ID is not null and sse.ACCESS_ID !=''
 ORDER BY sse.creattime DESC 
</select>
<!-- 异常流量  -->
<select id="getCountYcll" parameterType="hashmap" resultType="hashmap"> 
    select 
            ssp.IP as ip,
			ssp.ATTACK_IP as ATTACK_IP,
           sii.idc_short_name as IDC_NAME,
            ssp.ROOM_NAME as room_name,  
	        crc1.CRC_VALUE as event_type2
	      
 from  
     smms_event_main as sse
      
	  left join SMMS_PENDING_EVENT  as ssp
			   on sse.DETAIL_RID=ssp.rid
	  left join smms_idc_info as sii
			on ssp.ACCESS_ID=sii.IDC_ID
    left join smms_crc_mapting as crc1
		      on ssp.EVENT_TYPE2 = crc1.CRC_KEY 
       where	  ssp.recordstate ='0'  
           and ssp.LOG_TABLENAME='SMMS_AC_APP_VPN'  
			<!-- and sse.DETAIL_RID is not null and sse.DETAIL_RID!='' -->	
           and (crc1.CRC_TYPE='a' or crc1.CRC_TYPE ='r' or crc1.CRC_TYPE ='t')
		
           ORDER BY ssp.CREATTIME DESC 
				
           
</select>
<update id="updateWhiteList" parameterType="hashmap">
 		update SMMS_EVENT_MAIN   set IS_WHITE_LIST='1' where RID=#{RID}
 </update>
<update id="updateBlackList" parameterType="hashmap">
 		update SMMS_EVENT_MAIN   set IS_WHITE_LIST='2'
 		<where>
        <if test="ridCondition!=null and ridCondition!='' ">   
             ${ridCondition}
        </if>	
	</where>
 </update>
 <update id="deleteUpdateRecordstate" parameterType="hashmap" > 
	update SMMS_EVENT_MAIN  set RECORDSTATE=#{RECORDSTATE} 
      <where>
        <if test="ridCondition!=null and ridCondition!='' ">   
             ${ridCondition}
        </if>	
	</where>
  
</update>
 <update id="updateFinalRectifySuggest" parameterType="hashmap" > 
	update SMMS_EVENT_MAIN  set FINAL_RECTIFY_SUGGEST=#{FINAL_RECTIFY_SUGGEST},MODIFIEDTIME=#{MODIFIEDTIME} 
      <where>
        <if test="ridCondition!=null and ridCondition!='' ">   
             ${ridCondition}
        </if>	
	</where>
  
</update>
 
<select id="totalNum" parameterType="hashmap" resultType="hashmap"> 
	select count(*) NUM  from SMMS_EVENT_MAIN as ssp
	left join smms_idc_info as sii
    on ssp.ACCESS_ID=sii.IDC_ID
	<where>
		ssp.RECORDSTATE='0'
        <if test="whereCondition!=null and whereCondition!='' ">   
             ${whereCondition}
        </if>	
	</where>
</select> 

<delete id="deleteData" parameterType="hashmap" > 
	delete from SMMS_EVENT_MAIN  where RID = #{RID}
</delete> 

<select id="viewDetail" parameterType="hashmap" resultType="hashmap"> 
	select <include refid="detailColumns"/>,sii.IDC_NAME as TRANS_IDC_ID ,ssw.WEBSITE_NAME as TRANS_WEB_CASE_RID 
	from SMMS_EVENT_MAIN as ssp
	left join smms_idc_info as sii
    on ssp.ACCESS_ID=sii.IDC_ID
    left join 
    	S_USER as use
    	on ssp.ENFORCE_USER=use.USERID
    left join 
    SMMS_WEB_CASE as ssw
    on ssp.WEB_CASE_RID=ssw.RID
    where ssp.RID = #{RID} 
</select> 

<select id="selectByRid" resultType="hashmap"> 
      select ssp.RID,
            ssp.EVENT_SOURCE,
            ssp.CLIENTNAME,
            ssp.REPORT_CITY,
            ssp.EVENT_TYPE1,
            ssp.THREAT_LEVEL,
            ssp.THREAT_NAME,
            ssp.THREAT_TYPE1,
            ssp.THREAT_TYPE2,
            ssp.THREAT_TYPE3,
            ssp.THREAT_TYPE4,
            ssp.ACCESS_ID,
            ssp.ROOM_NAME,
            ssp.ROOM_IDX,
            ssp.DOMAIN_NAME,
            ssp.CC_DOMAIN,
            ssp.IP,
            ssp.ATTACK_IP,
            ssp.SYS_RECTIFY_SUGGEST,
            ssp.FINAL_RECTIFY_SUGGEST,
            ssp.IS_FORCE_CLOSE,
            ssp.IS_WHITE_LIST,
            ssp.FORCE_CLOSE_DESC,
            ssp.RECTIFY_TERM,
            ssp.CLOSE_TERM,
            ssp.SEND_TIME,
            ssp.SEND_TIMESTAMP,
            ssp.RECTIFY_STATE,
            ssp.RECTIFY_MEASURE,
            ssp.FEEDBACK_TIME,
            ssp.FEEDBACK_TIMESTAMP,
            ssp.WEB_CASE_RID,
            ssp.MAPPING_MODE,
            ssp.MEMO,
            ssp.CREATTIME,
            ssp.MODIFIEDTIME,
            ssp.RECORDSTATE,
            ssp.KEYWORDS,
            ssp.SNAPSHOP,
            ssp.DETIAL_COUNT,
            ssp.ENFORCE_COUNT,
            ssp.ENFORCE_USER,
            ssp.ENFORCE_TIME,
            ssp.URL,
            ssp.PRIORITY
            from SMMS_EVENT_MAIN ssp
      where ssp.RID = #{EVENT_MAINRID}  

</select> 

<update id="deleteUpdate" parameterType="hashmap" > 
	update SMMS_EVENT_MAIN  set RECORDSTATE=#{RECORDSTATE} where RID=#{RID}
</update> 
 
<select id="updateDetail" parameterType="String" resultType="hashmap"> 
      select <include refid="detailColumns"/> from SMMS_EVENT_MAIN  as ssp 
      left join smms_idc_info as sii
      on ssp.ACCESS_ID=sii.IDC_ID
      where ssp.RID = #{RID}  
</select> 

<select id="unblockApply" parameterType="hashmap" resultType="hashmap"> 
      select ACCESS_ID ,case when DOMAIN_NAME is null or DOMAIN_NAME=''  then ip  ELSE DOMAIN_NAME end as DOMAIN_NAME,ENFORCE_COUNT from SMMS_EVENT_MAIN  
      where RID = #{RID}  
</select>
<select id="forCloseApply" parameterType="hashmap" resultType="hashmap"> 
      select ACCESS_ID,ENFORCE_COUNT,CLOSE_COUNT from SMMS_EVENT_MAIN  
      where RID = #{RID}  
</select>
<update id="updateReState" parameterType="hashmap" > 
	update SMMS_EVENT_MAIN  
		<set>
			<if test="RECTIFY_STATE!=null"> RECTIFY_STATE=#{RECTIFY_STATE},</if> 
			 <if test="MODIFIEDTIME!=null"> MODIFIEDTIME=#{MODIFIEDTIME}, </if>
			<if test="ENFORCE_COUNT!=null"> ENFORCE_COUNT=#{ENFORCE_COUNT}</if> 
		   
		</set>
			where RID =#{RID}
</update> 

<update id="updateRectify" parameterType="hashmap" > 
	update SMMS_EVENT_MAIN  set RECTIFY_COUNT=RECTIFY_COUNT+1,MODIFIEDTIME=#{MODIFIEDTIME},RECTIFY_STATE=#{RECTIFY_STATE},FEEDBACK_TIME=#{FEEDBACK_TIME},FEEDBACK_TIMESTAMP=#{FEEDBACK_TIMESTAMP},RECTIFY_MEASURE=#{RECTIFY_MEASURE} 
    <where>
        <if test="CONDITION!=null and CONDITION!='' ">   
             ${CONDITION}
        </if>	
</where>
</update>
<update id="updateClose" parameterType="hashmap" > 
	update SMMS_EVENT_MAIN  set CLOSE_COUNT=CLOSE_COUNT+1,MODIFIEDTIME=#{MODIFIEDTIME},RECTIFY_STATE=#{RECTIFY_STATE},FEEDBACK_TIME=#{FEEDBACK_TIME},FEEDBACK_TIMESTAMP=#{FEEDBACK_TIMESTAMP},RECTIFY_MEASURE=#{RECTIFY_MEASURE} 
    <where>
        <if test="CONDITION!=null and CONDITION!='' ">   
             ${CONDITION}
        </if>	
</where>
</update>
<select id="selectUrlAndRid" parameterType="hashmap" resultType="hashmap"> 
      select IP,URL,RID as EVENT_RID from SMMS_EVENT_MAIN  
      <where>
        <if test="CONDITION!=null and CONDITION!='' ">   
             ${CONDITION}
        </if>	
	  </where>  
</select>
<select id="selectEventMailAfInWeb" parameterType="hashmap" resultType="hashmap"> 
      	select 								 
			ssp.CLIENTNAME as clientname,
            ssp.REPORT_CITY as report_city,
            ssp.REPORT_TIME as report_time,
            ssp.OCCUR_TIME as occur_time,
            ssp.THREAT_LEVEL as threat_level,
            ssp.THREAT_NAME as threat_name,
            ssp.THREAT_TYPE2 as threat_type2,
            ssp.IP as ip,
            ssp.DOMAIN_NAME as domain_name,
            ssp.URL as url,
            ssp.ACCESS_ID as access_id,
            ssp.ROOM_NAME as room_name,
            ssp.ROOM_IDX as room_idx,
            ssp.SNAPSHOP as snapshop,
            ssp.LOG_RID as log_rid,
            ssp.LOG_TABLENAME as log_tablename,
            ssp.MODIFIEDTIME as modifiedtime,
			ssp.CREATTIME as creattime,
			ssw.WEBSITE_NAME as web_case_name,
            ssp.PRIORITY as priority	          			
     from  SMMS_PENDING_EVENT  as ssp
     left join 
    	    SMMS_WEB_CASE as ssw
    	    on ssp.WEB_CASE_RID=ssw.RID
     <where>
       	ssp.recordstate ='0' 
       <if test="IP!=null and IP!='' "> and ssp.ip=#{IP} </if>
       		and ssp.access_id=#{ACCESS_ID} 
         	and	ssp.log_tablename ='SMMS_AF_LOG'    
            and  ssp.WEB_CASE_RID is not null and ssp.WEB_CASE_RID != ''
            and ssp.OCCUR_TIME  &gt;= #{STARTTIME} and ssp.OCCUR_TIME  &lt;= #{ENDTIME}
            ORDER BY ssp.OCCUR_TIME DESC 
        <if test="LIMIT!=null and LIMIT!='' ">  LIMIT #{LIMIT}  </if>   
         <if test="OFFSET!=null and OFFSET!='' ">   OFFSET #{OFFSET}  </if>   
     </where> 
</select>
<select id="selectEventMailAfInWebTotal" parameterType="hashmap" resultType="int"> 
      	select 	count(*)   
      		from  SMMS_PENDING_EVENT  as ssp
            left join 
    	         SMMS_WEB_CASE as ssw
    	    on 
    	    	ssp.WEB_CASE_RID=ssw.RID
     <where>
       	ssp.recordstate ='0' 
       <if test="IP!=null and IP!='' "> and ssp.ip=#{IP} </if>
       		and ssp.access_id=#{ACCESS_ID} 
         	and	ssp.log_tablename ='SMMS_AF_LOG'    
            and  ssp.WEB_CASE_RID is not null and ssp.WEB_CASE_RID != ''
            and ssp.OCCUR_TIME  &gt;= #{STARTTIME} and ssp.OCCUR_TIME  &lt;= #{ENDTIME}
     </where> 
</select>

<select id="selectEventMailAfNotInWeb" parameterType="hashmap" resultType="hashmap"> 
      select 								 
			ssp.CLIENTNAME as clientname,
            ssp.REPORT_CITY as report_city,
            ssp.REPORT_TIME as report_time,
            ssp.OCCUR_TIME as occur_time,
            ssp.THREAT_LEVEL as threat_level,
            ssp.THREAT_NAME as threat_name,
            ssp.THREAT_TYPE2 as threat_type2,
            ssp.IP as ip,
            ssp.DOMAIN_NAME as domain_name,
            ssp.URL as url,
            ssp.ACCESS_ID as access_id,
            ssp.ROOM_NAME as room_name,
            ssp.ROOM_IDX as room_idx,
            ssp.SNAPSHOP as snapshop,
            ssp.LOG_RID as log_rid,
            ssp.LOG_TABLENAME as log_tablename,
            ssp.MODIFIEDTIME as modifiedtime,
			ssp.CREATTIME as creattime,
			ssw.WEBSITE_NAME as web_case_name,
            ssp.PRIORITY as priority        			
     from   SMMS_PENDING_EVENT  as ssp
      left join 
    	    SMMS_WEB_CASE as ssw
    	    on ssp.WEB_CASE_RID=ssw.RID
      <where>
       	ssp.recordstate ='0' 
       <if test="IP!=null and IP!='' "> and ssp.ip=#{IP} </if>
            and ssp.access_id=#{ACCESS_ID}
            and ssp.log_tablename ='SMMS_AF_LOG' 
            and  (ssp.WEB_CASE_RID is  null or ssp.WEB_CASE_RID = '')
            and ssp.OCCUR_TIME  &gt;= #{STARTTIME} and ssp.OCCUR_TIME  &lt;= #{ENDTIME}
            ORDER BY ssp.OCCUR_TIME DESC 
	    <if test="LIMIT!=null and LIMIT!='' ">  LIMIT #{LIMIT} </if>   
         <if test="OFFSET!=null and OFFSET!='' "> OFFSET #{OFFSET} </if>   
     </where>
</select>

<select id="selectEventMailAfNotInWebTotal" parameterType="hashmap" resultType="int"> 
      select 								 
			count(*) 			
     from   SMMS_PENDING_EVENT  as ssp
      left join 
    	    SMMS_WEB_CASE as ssw
    	    on ssp.WEB_CASE_RID=ssw.RID
      <where>
       	ssp.recordstate ='0' 
       <if test="IP!=null and IP!='' "> and ssp.ip=#{IP} </if>
            and ssp.access_id=#{ACCESS_ID}
            and ssp.log_tablename ='SMMS_AF_LOG' 
            and  (ssp.WEB_CASE_RID is  null or ssp.WEB_CASE_RID = '')
            and ssp.OCCUR_TIME  &gt;= #{STARTTIME} and ssp.OCCUR_TIME  &lt;= #{ENDTIME}
     </where>
</select>

<select id="selectEventMailAcInWeb" parameterType="hashmap" resultType="hashmap"> 
  select 
            ssp.CLIENTNAME as clientname,
            ssp.REPORT_CITY as report_city,
            ssp.REPORT_TIME as report_time,
            ssp.OCCUR_TIME as occur_time,
            ssp.EVENT_TYPE1 as event_type1,
            ssp.IP as ip,
            ssp.DOMAIN_NAME as domain_name,
            ssp.URL as url,
            ssp.ACCESS_ID as access_id,
            ssp.ROOM_NAME as room_name,
            ssp.ROOM_IDX as room_idx,
	        ssp.LOG_RID as log_rid,
            ssp.LOG_TABLENAME as log_tablename,
            ssp.LOG_FILENAME as log_filename,
            ssp.MODIFIEDTIME as modifiedtime,
	        ssw.WEBSITE_NAME as web_case_name,
	        crc1.CRC_VALUE as event_type2,
	        crc2.CRC_VALUE as event_type3  
 from   
     SMMS_PENDING_EVENT  as ssp
	         
	  left join SMMS_WEB_CASE as ssw
              on ssp.WEB_CASE_RID=ssw.RID
      left join smms_crc_mapting as crc1
		      on ssp.EVENT_TYPE2 = crc1.CRC_KEY 
	  left join smms_crc_mapting as crc2
		      on ssp.EVENT_TYPE3 = crc2.CRC_KEY 
	<where>
       	ssp.recordstate ='0' 
       <if test="IP!=null and IP!='' "> and ssp.ip=#{IP} </if>
            and ssp.access_id=#{ACCESS_ID}
			   and ssp.WEB_CASE_RID is not null and ssp.WEB_CASE_RID != ''
               and ssp.log_tablename != 'SMMS_AF_LOG' 
               and (crc1.CRC_TYPE='a' or crc1.CRC_TYPE ='r' or crc1.CRC_TYPE ='t')
		       and (crc2.CRC_TYPE='a' or crc2.CRC_TYPE ='r' or crc2.CRC_TYPE ='t')
               and ssp.OCCUR_TIME  &gt;= #{STARTTIME} and ssp.OCCUR_TIME  &lt;= #{ENDTIME}
               ORDER BY ssp.OCCUR_TIME DESC 
        <if test="LIMIT!=null and LIMIT!='' ">  LIMIT #{LIMIT} </if>   
        <if test="OFFSET!=null and OFFSET!='' "> OFFSET #{OFFSET} </if>   
	</where>
</select>

<select id="selectEventMailAcInWebTotal" parameterType="hashmap" resultType="int"> 
  select 
            count(*)
 from   
     SMMS_PENDING_EVENT  as ssp
	         
	  left join SMMS_WEB_CASE as ssw
              on ssp.WEB_CASE_RID=ssw.RID
      left join smms_crc_mapting as crc1
		      on ssp.EVENT_TYPE2 = crc1.CRC_KEY 
	  left join smms_crc_mapting as crc2
		      on ssp.EVENT_TYPE3 = crc2.CRC_KEY 
	<where>
       	ssp.recordstate ='0' 
       <if test="IP!=null and IP!='' "> and ssp.ip=#{IP} </if>
            and ssp.access_id=#{ACCESS_ID}
			   and ssp.WEB_CASE_RID is not null and ssp.WEB_CASE_RID != ''
               and ssp.log_tablename != 'SMMS_AF_LOG' 
               and (crc1.CRC_TYPE='a' or crc1.CRC_TYPE ='r' or crc1.CRC_TYPE ='t')
		       and (crc2.CRC_TYPE='a' or crc2.CRC_TYPE ='r' or crc2.CRC_TYPE ='t')
               and ssp.OCCUR_TIME  &gt;= #{STARTTIME} and ssp.OCCUR_TIME  &lt;= #{ENDTIME} 
	</where>
</select>

<select id="selectEventMailAcNotInWeb" parameterType="hashmap" resultType="hashmap"> 
      select 
            ssp.CLIENTNAME as clientname,
            ssp.REPORT_CITY as report_city,
            ssp.REPORT_TIME as report_time,
            ssp.OCCUR_TIME as occur_time,
            ssp.EVENT_TYPE1 as event_type1,
            ssp.IP as ip,
            ssp.DOMAIN_NAME as domain_name,
            ssp.URL as url,
            ssp.ACCESS_ID as access_id,
            ssp.ROOM_NAME as room_name,
            ssp.ROOM_IDX as room_idx,
	        ssp.LOG_RID as log_rid,
            ssp.LOG_TABLENAME as log_tablename,
            ssp.LOG_FILENAME as log_filename,
            ssp.MODIFIEDTIME as modifiedtime,
	        ssw.WEBSITE_NAME as web_case_name,
	        crc1.CRC_VALUE as event_type2,
	        crc2.CRC_VALUE as event_type3  
 from  SMMS_PENDING_EVENT  as ssp
	        
	  left join SMMS_WEB_CASE as ssw
              on ssp.WEB_CASE_RID=ssw.RID
      left join smms_crc_mapting as crc1
		      on ssp.EVENT_TYPE2 = crc1.CRC_KEY 
	  left join smms_crc_mapting as crc2
		      on ssp.EVENT_TYPE3 = crc2.CRC_KEY 
	<where>
       	ssp.recordstate ='0' 
       <if test="IP!=null and IP!='' "> and ssp.ip=#{IP} </if>
            and ssp.access_id=#{ACCESS_ID}
		 	   and (ssp.WEB_CASE_RID is  null or ssp.WEB_CASE_RID = '')
		  	   and ssp.log_tablename != 'SMMS_AF_LOG'
               and (crc1.CRC_TYPE='a' or crc1.CRC_TYPE ='r' or crc1.CRC_TYPE ='t')
		       and (crc2.CRC_TYPE='a' or crc2.CRC_TYPE ='r' or crc2.CRC_TYPE ='t') 
               and ssp.OCCUR_TIME &gt;= #{STARTTIME} and ssp.OCCUR_TIME  &lt;= #{ENDTIME}
               ORDER BY ssp.OCCUR_TIME DESC 
        <if test="LIMIT!=null and LIMIT!='' ">  LIMIT #{LIMIT} </if>   
        <if test="OFFSET!=null and OFFSET!='' "> OFFSET #{OFFSET} </if>   
      </where>
</select>

<select id="selectEventMailAcNotInWebTotal" parameterType="hashmap" resultType="int"> 
      select 
            count(*)
 	  from  SMMS_PENDING_EVENT  as ssp
	        
	  left join SMMS_WEB_CASE as ssw
              on ssp.WEB_CASE_RID=ssw.RID
      left join smms_crc_mapting as crc1
		      on ssp.EVENT_TYPE2 = crc1.CRC_KEY 
	  left join smms_crc_mapting as crc2
		      on ssp.EVENT_TYPE3 = crc2.CRC_KEY 
	<where>
       	ssp.recordstate ='0' 
       <if test="IP!=null and IP!='' "> and ssp.ip=#{IP} </if>
            and ssp.access_id=#{ACCESS_ID}
		 	   and (ssp.WEB_CASE_RID is  null or ssp.WEB_CASE_RID = '')
		  	   and ssp.log_tablename != 'SMMS_AF_LOG'
               and (crc1.CRC_TYPE='a' or crc1.CRC_TYPE ='r' or crc1.CRC_TYPE ='t')
		       and (crc2.CRC_TYPE='a' or crc2.CRC_TYPE ='r' or crc2.CRC_TYPE ='t') 
               and ssp.OCCUR_TIME &gt;= #{STARTTIME} and ssp.OCCUR_TIME  &lt;= #{ENDTIME}
      </where>
</select>
<insert id="insertSave" parameterType="hashmap" >
	insert into SMMS_EVENT_MAIN (
            
            <if test="EVENT_SOURCE != null ">EVENT_SOURCE,</if>
            <if test="CLIENTNAME != null ">CLIENTNAME,</if>
            <if test="REPORT_CITY != null ">REPORT_CITY,</if>
            <if test="EVENT_TYPE1 != null ">EVENT_TYPE1,</if>
            THREAT_LEVEL,
            THREAT_NAME,
            THREAT_TYPE1,
            <if test="THREAT_TYPE2 != null ">THREAT_TYPE2,</if>
            <if test="THREAT_TYPE3 != null ">THREAT_TYPE3,</if>
            <if test="THREAT_TYPE4 != null ">THREAT_TYPE4,</if>
            <if test="ACCESS_ID != null ">ACCESS_ID,</if>
            <if test="ROOM_NAME != null ">ROOM_NAME,</if>
            <if test="ROOM_IDX != null ">ROOM_IDX,</if>
            <if test="DOMAIN_NAME != null ">DOMAIN_NAME,</if>
            <if test="CC_DOMAIN != null ">CC_DOMAIN,</if>
            <if test="IP != null ">IP,</if>
            <if test="ATTACK_IP != null ">ATTACK_IP,</if>
            <if test="SYS_RECTIFY_SUGGEST != null ">SYS_RECTIFY_SUGGEST,</if>
            <if test="FINAL_RECTIFY_SUGGEST != null ">FINAL_RECTIFY_SUGGEST,</if>
            IS_FORCE_CLOSE,
            IS_WHITE_LIST,
            <if test="FORCE_CLOSE_DESC != null ">FORCE_CLOSE_DESC,</if>
            <if test="RECTIFY_TERM != null ">RECTIFY_TERM,</if>
            <if test="CLOSE_TERM != null ">CLOSE_TERM,</if>
            <if test="SEND_TIME != null ">SEND_TIME,</if>
            <if test="SEND_TIMESTAMP != null ">SEND_TIMESTAMP,</if>
            <if test="RECTIFY_STATE != null ">RECTIFY_STATE,</if>
            <if test="RECTIFY_MEASURE != null ">RECTIFY_MEASURE,</if>
            <if test="FEEDBACK_TIME != null ">FEEDBACK_TIME,</if>
            <if test="FEEDBACK_TIMESTAMP != null ">FEEDBACK_TIMESTAMP,</if>
            <if test="WEB_CASE_RID != null ">WEB_CASE_RID,</if>
            <if test="MAPPING_MODE != null ">MAPPING_MODE,</if>
            <if test="MEMO != null ">MEMO,</if>
            <if test="CREATTIME != null ">CREATTIME,</if>
            <if test="MODIFIEDTIME != null ">MODIFIEDTIME,</if>
            <if test="RECORDSTATE != null ">RECORDSTATE,</if>
            <if test="SNAPSHOP !=null">SNAPSHOP,</if>
            <if test="KEYWORDS != null ">KEYWORDS,</if>
            <if test="URL != null ">URL,</if>
            <if test="DETIAL_COUNT != null ">DETIAL_COUNT,</if>
            <if test="ENFORCE_COUNT != null ">ENFORCE_COUNT,</if>
            <if test="ENFORCE_TIME != null ">ENFORCE_TIME,</if>
            <if test="ENFORCE_USER != null ">ENFORCE_USER,</if>
            <if test="RECTIFY_COUNT != null ">RECTIFY_COUNT,</if>
            <if test="CLOSE_COUNT != null ">CLOSE_COUNT,</if>
            <if test="PRIORITY != null ">PRIORITY,</if>
            <if test="EVENT_INDEX != null ">EVENT_INDEX,</if>
            <if test="DETAIL_RID != null ">DETAIL_RID,</if>
            <if test="RID != null ">RID</if>
            )
	   values (
           
           <if test="EVENT_SOURCE != null ">#{EVENT_SOURCE},</if>
           <if test="CLIENTNAME != null ">#{CLIENTNAME},</if>
           <if test="REPORT_CITY != null ">#{REPORT_CITY},</if>
           <if test="EVENT_TYPE1 != null ">#{EVENT_TYPE1},</if>
           <if test="THREAT_LEVEL != null ">#{THREAT_LEVEL},</if><if test="THREAT_LEVEL == null ">1,</if>
           <if test="THREAT_NAME != null ">#{THREAT_NAME},</if><if test="THREAT_NAME == null ">999,</if>
           <if test="THREAT_TYPE1 != null ">#{THREAT_TYPE1},</if><if test="THREAT_TYPE1 == null ">99,</if>
           <if test="THREAT_TYPE2 != null ">#{THREAT_TYPE2},</if>
           <if test="THREAT_TYPE3 != null ">#{THREAT_TYPE3},</if>
           <if test="THREAT_TYPE4 != null ">#{THREAT_TYPE4},</if>
           <if test="ACCESS_ID != null ">#{ACCESS_ID},</if>
           <if test="ROOM_NAME != null ">#{ROOM_NAME},</if>
           <if test="ROOM_IDX != null ">#{ROOM_IDX},</if>
           <if test="DOMAIN_NAME != null ">#{DOMAIN_NAME},</if>
           <if test="CC_DOMAIN != null ">#{CC_DOMAIN},</if>
           <if test="IP != null ">#{IP},</if>
           <if test="ATTACK_IP != null ">#{ATTACK_IP},</if>
           <if test="SYS_RECTIFY_SUGGEST != null ">#{SYS_RECTIFY_SUGGEST},</if>
           <if test="FINAL_RECTIFY_SUGGEST != null ">#{FINAL_RECTIFY_SUGGEST},</if>
           <if test="IS_FORCE_CLOSE != null ">#{IS_FORCE_CLOSE},</if><if test="IS_FORCE_CLOSE ==null">2,</if>
           <if test="IS_WHITE_LIST != null ">#{IS_WHITE_LIST},</if><if test="IS_WHITE_LIST ==null">2,</if>
           <if test="FORCE_CLOSE_DESC != null ">#{FORCE_CLOSE_DESC},</if>
           <if test="RECTIFY_TERM != null ">#{RECTIFY_TERM},</if>
           <if test="CLOSE_TERM != null ">#{CLOSE_TERM},</if>
           <if test="SEND_TIME != null ">#{SEND_TIME},</if>
           <if test="SEND_TIMESTAMP != null ">#{SEND_TIMESTAMP},</if>
           <if test="RECTIFY_STATE != null ">#{RECTIFY_STATE},</if>
           <if test="RECTIFY_MEASURE != null ">#{RECTIFY_MEASURE},</if>
           <if test="FEEDBACK_TIME != null ">#{FEEDBACK_TIME},</if>
           <if test="FEEDBACK_TIMESTAMP != null ">#{FEEDBACK_TIMESTAMP},</if>
           <if test="WEB_CASE_RID != null ">#{WEB_CASE_RID},</if>
           <if test="MAPPING_MODE != null ">#{MAPPING_MODE},</if>
           <if test="MEMO != null ">#{MEMO},</if>
           <if test="CREATTIME != null ">#{CREATTIME},</if>
           <if test="MODIFIEDTIME != null ">#{MODIFIEDTIME},</if>
           <if test="RECORDSTATE != null ">#{RECORDSTATE},</if>
           <if test="SNAPSHOP !=null">#{SNAPSHOP},</if>
           <if test="KEYWORDS != null ">#{KEYWORDS},</if>
           <if test="URL != null ">#{URL},</if>
           <if test="DETIAL_COUNT != null ">#{DETIAL_COUNT},</if>
          <if test="ENFORCE_COUNT  != null ">#{ENFORCE_COUNT},</if>
          <if test="ENFORCE_TIME  != null ">#{ENFORCE_TIME},</if>
          <if test="ENFORCE_USER  != null ">#{ENFORCE_USER},</if>
          <if test="RECTIFY_COUNT  != null ">#{RECTIFY_COUNT},</if>
          <if test="CLOSE_COUNT  != null ">#{CLOSE_COUNT},</if>
          <if test="PRIORITY  != null ">#{PRIORITY},</if>
          <if test="EVENT_INDEX  != null ">#{EVENT_INDEX},</if>
          <if test="DETAIL_RID  != null ">#{DETAIL_RID},</if>
           <if test="RID != null ">#{RID}</if>)
</insert> 

<update id="updateSave" parameterType="hashmap" > 
	update SMMS_EVENT_MAIN   
		<set>
				    <if test="EVENT_SOURCE!=null"> EVENT_SOURCE=#{EVENT_SOURCE},</if> 
		    <if test="CLIENTNAME!=null"> CLIENTNAME=#{CLIENTNAME},</if> 
		    <if test="REPORT_CITY!=null"> REPORT_CITY=#{REPORT_CITY},</if> 
		    <if test="EVENT_TYPE1!=null"> EVENT_TYPE1=#{EVENT_TYPE1},</if> 
		    <if test="THREAT_LEVEL!=null"> THREAT_LEVEL=#{THREAT_LEVEL},</if> 
		    <if test="THREAT_NAME!=null"> THREAT_NAME=#{THREAT_NAME},</if> 
		    <if test="THREAT_TYPE1!=null"> THREAT_TYPE1=#{THREAT_TYPE1},</if> 
		    <if test="THREAT_TYPE2!=null"> THREAT_TYPE2=#{THREAT_TYPE2},</if> 
		    <if test="THREAT_TYPE3!=null"> THREAT_TYPE3=#{THREAT_TYPE3},</if> 
		    <if test="THREAT_TYPE4!=null"> THREAT_TYPE4=#{THREAT_TYPE4},</if> 
		    <if test="ACCESS_ID!=null"> ACCESS_ID=#{ACCESS_ID},</if> 
		    <if test="ROOM_NAME!=null"> ROOM_NAME=#{ROOM_NAME},</if> 
		    <if test="ROOM_IDX!=null"> ROOM_IDX=#{ROOM_IDX},</if> 
		    <if test="DOMAIN_NAME!=null"> DOMAIN_NAME=#{DOMAIN_NAME},</if> 
		    <if test="CC_DOMAIN!=null"> CC_DOMAIN=#{CC_DOMAIN},</if> 
		    <if test="IP!=null"> IP=#{IP},</if> 
		    <if test="ATTACK_IP!=null"> ATTACK_IP=#{ATTACK_IP},</if> 
		    <if test="SYS_RECTIFY_SUGGEST!=null"> SYS_RECTIFY_SUGGEST=#{SYS_RECTIFY_SUGGEST},</if> 
		    <if test="FINAL_RECTIFY_SUGGEST!=null"> FINAL_RECTIFY_SUGGEST=#{FINAL_RECTIFY_SUGGEST},</if> 
		    <if test="IS_FORCE_CLOSE!=null"> IS_FORCE_CLOSE=#{IS_FORCE_CLOSE},</if> 
		    <if test="IS_WHITE_LIST!=null"> IS_WHITE_LIST=#{IS_WHITE_LIST},</if> 
		    <if test="FORCE_CLOSE_DESC!=null"> FORCE_CLOSE_DESC=#{FORCE_CLOSE_DESC},</if> 
		    <if test="RECTIFY_TERM!=null"> RECTIFY_TERM=#{RECTIFY_TERM},</if> 
		    <if test="CLOSE_TERM!=null"> CLOSE_TERM=#{CLOSE_TERM},</if> 
		    <if test="SEND_TIME!=null"> SEND_TIME=#{SEND_TIME},</if> 
		    <if test="SEND_TIMESTAMP!=null"> SEND_TIMESTAMP=#{SEND_TIMESTAMP},</if> 
		    <if test="RECTIFY_STATE!=null"> RECTIFY_STATE=#{RECTIFY_STATE},</if> 
		    <if test="RECTIFY_MEASURE!=null"> RECTIFY_MEASURE=#{RECTIFY_MEASURE},</if> 
		    <if test="FEEDBACK_TIME!=null"> FEEDBACK_TIME=#{FEEDBACK_TIME},</if> 
		    <if test="FEEDBACK_TIMESTAMP!=null"> FEEDBACK_TIMESTAMP=#{FEEDBACK_TIMESTAMP},</if> 
		    <if test="WEB_CASE_RID!=null"> WEB_CASE_RID=#{WEB_CASE_RID},</if> 
		    <if test="MAPPING_MODE!=null"> MAPPING_MODE=#{MAPPING_MODE},</if> 
		    <if test="MEMO!=null"> MEMO=#{MEMO},</if> 
		    <if test="MODIFIEDTIME!=null"> MODIFIEDTIME=#{MODIFIEDTIME},</if> 
		    <if test="RECORDSTATE!=null"> RECORDSTATE=#{RECORDSTATE},</if> 
		    <if test="SNAPSHOP !=null">SNAPSHOP=#{SNAPSHOP},</if>
            <if test="KEYWORDS != null ">KEYWORDS=#{KEYWORDS},</if>
             <if test="DETIAL_COUNT != null ">DETIAL_COUNT=#{DETIAL_COUNT},</if>
             <if test="ENFORCE_COUNT  != null ">ENFORCE_COUNT=#{ENFORCE_COUNT},</if>
             <if test="ENFORCE_TIME  != null ">ENFORCE_TIME=#{ENFORCE_TIME},</if>
             <if test="ENFORCE_USER  != null ">ENFORCE_USER=#{ENFORCE_USER},</if>
             <if test="RECTIFY_COUNT  != null ">RECTIFY_COUNT=#{RECTIFY_COUNT},</if>
              <if test="CLOSE_COUNT  != null ">CLOSE_COUNT=#{CLOSE_COUNT},</if>
             <if test="EVENT_INDEX  != null ">EVENT_INDEX=#{EVENT_INDEX},</if>
             <if test="PRIORITY  != null ">PRIORITY=#{PRIORITY},</if>
             <if test="DETAIL_RID  != null ">DETAIL_RID=#{DETAIL_RID},</if>
             <if test="URL != null ">URL=#{URL},</if>
		</set>
	where RID=#{RID}
</update>

</mapper>
