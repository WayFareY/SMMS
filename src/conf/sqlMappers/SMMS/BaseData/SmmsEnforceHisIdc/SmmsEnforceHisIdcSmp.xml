<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
<mapper namespace="SmmsEnforceHisIdc"> 
<sql id="listColumns">
	
            his.RID,
            his.EVENT_MAINRID,
            his.ENFORCE_USER,
            his.EVENT_SOURCE,
            his.CLIENTNAME,
            his.ENFORCE_TIME,
            his.REPORT_CITY,
            his.EVENT_TYPE1,
            his.THREAT_LEVEL,
            his.THREAT_NAME,
            his.THREAT_TYPE1,
            his.THREAT_TYPE2,
            his.THREAT_TYPE3,
            his.THREAT_TYPE4,
            his.ACCESS_ID,
            his.ROOM_NAME,
            his.ROOM_IDX,
            his.DOMAIN_NAME,
            his.CC_DOMAIN,
            his.IP,
            his.ATTACK_IP,
            his.SYS_RECTIFY_SUGGEST,
            his.FINAL_RECTIFY_SUGGEST,
            his.IS_FORCE_CLOSE,
            his.IS_WHITE_LIST,
            his.FORCE_CLOSE_DESC,
            his.RECTIFY_TERM,
            his.CLOSE_TERM,
            his.SEND_TIME,
            his.SEND_TIMESTAMP,
            his.RECTIFY_STATE,
            his.RECTIFY_MEASURE,
            his.FEEDBACK_TIME,
            his.FEEDBACK_TIMESTAMP,
            his.WEB_CASE_RID,
            his.MAPPING_MODE,
            his.MEMO,
            his.CREATTIME,
            his.MODIFIEDTIME,
            his.RECORDSTATE,
            his.KEYWORDS,
            his.SNAPSHOP,
            his.DETIAL_COUNT,
            his.ENFORCE_COUNT,
            his.PRIORITY,
            his.URL,
            sii.IDC_ID,
            sii.IDC_NAME
</sql>
<sql id="detailColumns">
	
            his.RID,
            his.EVENT_MAINRID,
            his.ENFORCE_USER,
            his.EVENT_SOURCE,
            his.CLIENTNAME,
            his.ENFORCE_TIME,
            his.REPORT_CITY,
            his.EVENT_TYPE1,
            his.THREAT_LEVEL,
            his.THREAT_NAME,
            his.THREAT_TYPE1,
            his.THREAT_TYPE2,
            his.THREAT_TYPE3,
            his.THREAT_TYPE4,
            his.ACCESS_ID,
            his.ROOM_NAME,
            his.ROOM_IDX,
            his.DOMAIN_NAME,
            his.CC_DOMAIN,
            his.IP,
            his.ATTACK_IP,
            his.SYS_RECTIFY_SUGGEST,
            his.FINAL_RECTIFY_SUGGEST,
            his.IS_FORCE_CLOSE,
            his.IS_WHITE_LIST,
            his.FORCE_CLOSE_DESC,
            his.RECTIFY_TERM,
            his.CLOSE_TERM,
            his.SEND_TIME,
            his.SEND_TIMESTAMP,
            his.RECTIFY_STATE,
            his.RECTIFY_MEASURE,
            his.FEEDBACK_TIME,
            his.FEEDBACK_TIMESTAMP,
            his.WEB_CASE_RID,
            his.MAPPING_MODE,
            his.MEMO,
            his.CREATTIME,
            his.MODIFIEDTIME,
            his.RECORDSTATE,
            his.KEYWORDS,
            his.SNAPSHOP,
            his.DETIAL_COUNT,
            his.ENFORCE_COUNT,
            his.PRIORITY,
            his.URL,
            sii.IDC_ID,
            sii.IDC_NAME
</sql>
<select id="listData" parameterType="hashmap" resultType="hashmap"> 
	select <include refid="listColumns"/>, sii.IDC_NAME as TRANS_IDC_ID ,ssw.WEBSITE_NAME as TRANS_WEB_CASE_RID
	 from SMMS_ENFORCE_HIS AS his left join 
    	SMMS_WEB_CASE as ssw
    	on his.WEB_CASE_RID=ssw.RID
    	left JOIN smms_idc_info as sii 
    	on his.ACCESS_ID=sii.IDC_ID
	<where>
		his.RECORDSTATE='0'
        <if test="whereCondition!=null and whereCondition!='' ">   
             ${whereCondition}
        </if>		
	</where>
        <if test="order!=null and order!='' ">   
             order by ${order}
        </if>				
</select> 

<select id="totalNum" parameterType="hashmap" resultType="hashmap"> 
	select count(*) NUM  from SMMS_ENFORCE_HIS as his
	left JOIN smms_idc_info as sii on his.ACCESS_ID=sii.IDC_ID
	<where>
		his.RECORDSTATE='0'
        <if test="whereCondition!=null and whereCondition!='' ">   
             ${whereCondition}
        </if>	
	</where>
</select> 
<update id="stateUpdate" parameterType="hashmap">
	update SMMS_ENFORCE_HIS set 
	RECTIFY_MEASURE=#{RECTIFY_MEASURE},
	RECTIFY_STATE=#{RECTIFY_STATE},
	FEEDBACK_TIME=#{FEEDBACK_TIME},
	FEEDBACK_TIMESTAMP=#{FEEDBACK_TIMESTAMP},
	MODIFIEDTIME=#{MODIFIEDTIME}
	where EVENT_MAINRID=#{RID}
</update>
<delete id="deleteData" parameterType="hashmap" > 
	delete from SMMS_ENFORCE_HIS  where RID = #{RID}
</delete> 
<update id="updateReStateAfter" parameterType="hashmap" > 
	update SMMS_ENFORCE_HIS   
		<set>
		    <if test="RECTIFY_STATE!=null"> RECTIFY_STATE=#{RECTIFY_STATE},</if> 
		    <if test="MODIFIEDTIME!=null"> MODIFIEDTIME=#{MODIFIEDTIME}</if> 
		</set>
	where EVENT_MAINRID=#{RID} 
</update>
<select id="viewDetail" parameterType="hashmap" resultType="hashmap"> 
	select <include refid="detailColumns"/>  from SMMS_ENFORCE_HIS  where RID = #{RID} 
</select> 

<update id="deleteUpdate" parameterType="hashmap" > 
	update SMMS_ENFORCE_HIS  set RECORDSTATE=#{RECORDSTATE} where RID=#{RID}
</update> 
 
<select id="updateDetail" parameterType="String" resultType="hashmap"> 
      select <include refid="detailColumns"/> from SMMS_ENFORCE_HIS  where RID = #{RID} 
</select> 

<insert id="insertSave" parameterType="hashmap" >
	insert into SMMS_ENFORCE_HIS (
            <if test="RID != null ">RID,</if>
            <if test="EVENT_MAINRID != null ">EVENT_MAINRID,</if>
            <if test="ENFORCE_USER != null ">ENFORCE_USER,</if>
            <if test="EVENT_SOURCE != null ">EVENT_SOURCE,</if>
            <if test="CLIENTNAME != null ">CLIENTNAME,</if>
            <if test="ENFORCE_TIME != null ">ENFORCE_TIME,</if>
            <if test="REPORT_CITY != null ">REPORT_CITY,</if>
            <if test="EVENT_TYPE1 != null ">EVENT_TYPE1,</if>
            <if test="THREAT_LEVEL != null ">THREAT_LEVEL,</if>
            <if test="THREAT_NAME != null ">THREAT_NAME,</if>
            <if test="THREAT_TYPE1 != null ">THREAT_TYPE1,</if>
            <if test="THREAT_TYPE2 != null ">THREAT_TYPE2,</if>
            <if test="THREAT_TYPE3 != null ">THREAT_TYPE3,</if>
            <if test="THREAT_TYPE4 != null ">THREAT_TYPE4,</if>
            <if test="ACCESS_ID != null ">ACCESS_ID,</if>
            <if test="ROOM_NAME != null ">ROOM_NAME,</if>
            <if test="ROOM_IDX != null ">ROOM_IDX,</if>
            <if test="DOMAIN_NAME != null ">DOMAIN_NAME,</if>
            <if test="CC_DOMAIN != null ">CC_DOMAIN,</if>
            <if test="IP != null ">IP,</if>
            <if test="ATTACK_IP != null ">ATTACK_IP,</if>
            <if test="SYS_RECTIFY_SUGGEST != null ">SYS_RECTIFY_SUGGEST,</if>
            <if test="FINAL_RECTIFY_SUGGES != null ">FINAL_RECTIFY_SUGGES,</if>
            <if test="IS_FORCE_CLOSE != null ">IS_FORCE_CLOSE,</if>
            <if test="IS_WHITE_LIST != null ">IS_WHITE_LIST,</if>
            <if test="FORCE_CLOSE_DESC != null ">FORCE_CLOSE_DESC,</if>
            <if test="RECTIFY_TERM != null ">RECTIFY_TERM,</if>
            <if test="CLOSE_TERM != null ">CLOSE_TERM,</if>
            <if test="SEND_TIME != null ">SEND_TIME,</if>
            <if test="SEND_TIMESTAMP != null ">SEND_TIMESTAMP,</if>
            <if test="RECTIFY_STATE != null ">RECTIFY_STATE,</if>
            <if test="RECTIFY_MEASURE != null ">RECTIFY_MEASURE,</if>
            <if test="FEEDBACK_TIME != null ">FEEDBACK_TIME,</if>
            <if test="FEEDBACK_TIMESTAMP != null ">FEEDBACK_TIMESTAMP,</if>
            <if test="WEB_CASE_RID != null ">WEB_CASE_RID,</if>
            <if test="MAPPING_MODE != null ">MAPPING_MODE,</if>
            <if test="DETIAL_COUNT != null ">DETIAL_COUNT,</if>
            <if test="ENFORCE_COUNT != null ">ENFORCE_COUNT,</if>
            <if test="URL != null ">URL,</if>
            <if test="SNAPSHOP != null ">SNAPSHOP,</if>
            <if test="KEYWORDS != null ">KEYWORDS,</if>
            <if test="MEMO != null ">MEMO,</if>
            <if test="CREATTIME != null ">CREATTIME,</if>
            <if test="MODIFIEDTIME != null ">MODIFIEDTIME,</if>
            <if test="RECORDSTATE != null ">RECORDSTATE</if>)
	   values (
           <if test="RID != null ">#{RID},</if>
           <if test="EVENT_MAINRID != null ">#{EVENT_MAINRID},</if>
           <if test="ENFORCE_USER != null ">#{ENFORCE_USER},</if>
           <if test="EVENT_SOURCE != null ">#{EVENT_SOURCE},</if>
           <if test="CLIENTNAME != null ">#{CLIENTNAME},</if>
           <if test="REPORT_CITY != null ">#{REPORT_CITY},</if>
           <if test="ENFORCE_TIME != null ">#{ENFORCE_TIME},</if>
           <if test="EVENT_TYPE1 != null ">#{EVENT_TYPE1},</if>
           <if test="THREAT_LEVEL != null ">#{THREAT_LEVEL},</if>
           <if test="THREAT_NAME != null ">#{THREAT_NAME},</if>
           <if test="THREAT_TYPE1 != null ">#{THREAT_TYPE1},</if>
           <if test="THREAT_TYPE2 != null ">#{THREAT_TYPE2},</if>
           <if test="THREAT_TYPE3 != null ">#{THREAT_TYPE3},</if>
           <if test="THREAT_TYPE4 != null ">#{THREAT_TYPE4},</if>
           <if test="ACCESS_ID != null ">#{ACCESS_ID},</if>
           <if test="ROOM_NAME != null ">#{ROOM_NAME},</if>
           <if test="ROOM_IDX != null ">#{ROOM_IDX},</if>
           <if test="DOMAIN_NAME != null ">#{DOMAIN_NAME},</if>
           <if test="CC_DOMAIN != null ">#{CC_DOMAIN},</if>
           <if test="IP != null ">#{IP},</if>
           <if test="ATTACK_IP != null ">#{ATTACK_IP},</if>
           <if test="SYS_RECTIFY_SUGGEST != null ">#{SYS_RECTIFY_SUGGEST},</if>
           <if test="FINAL_RECTIFY_SUGGES != null ">#{FINAL_RECTIFY_SUGGES},</if>
           <if test="IS_FORCE_CLOSE != null ">#{IS_FORCE_CLOSE},</if>
           <if test="IS_WHITE_LIST != null ">#{IS_WHITE_LIST},</if>
           <if test="FORCE_CLOSE_DESC != null ">#{FORCE_CLOSE_DESC},</if>
           <if test="RECTIFY_TERM != null ">#{RECTIFY_TERM},</if>
           <if test="CLOSE_TERM != null ">#{CLOSE_TERM},</if>
           <if test="SEND_TIME != null ">#{SEND_TIME},</if>
           <if test="SEND_TIMESTAMP != null ">#{SEND_TIMESTAMP},</if>
           <if test="RECTIFY_STATE != null ">#{RECTIFY_STATE},</if>
           <if test="RECTIFY_MEASURE != null ">#{RECTIFY_MEASURE},</if>
           <if test="FEEDBACK_TIME != null ">#{FEEDBACK_TIME},</if>
           <if test="FEEDBACK_TIMESTAMP != null ">#{FEEDBACK_TIMESTAMP},</if>
           <if test="WEB_CASE_RID != null ">#{WEB_CASE_RID},</if>
           <if test="MAPPING_MODE != null ">#{MAPPING_MODE},</if>
           <if test="DETIAL_COUNT != null ">#{DETIAL_COUNT},</if>
           <if test="ENFORCE_COUNT != null ">#{ENFORCE_COUNT},</if>
           <if test="URL != null ">#{URL},</if>
           <if test="SNAPSHOP != null ">#{SNAPSHOP},</if>
           <if test="KEYWORDS != null ">#{KEYWORDS},</if>
           <if test="MEMO != null ">#{MEMO},</if>
           <if test="CREATTIME != null ">#{CREATTIME},</if>
           <if test="MODIFIEDTIME != null ">#{MODIFIEDTIME},</if>
           <if test="RECORDSTATE != null ">#{RECORDSTATE}</if>)
</insert> 

<update id="updateSave" parameterType="hashmap" > 
	update SMMS_ENFORCE_HIS   
		<set>
				    <if test="EVENT_MAINRID!=null"> EVENT_MAINRID=#{EVENT_MAINRID},</if> 
		    <if test="ENFORCE_USER!=null"> ENFORCE_USER=#{ENFORCE_USER},</if> 
		    <if test="EVENT_SOURCE!=null"> EVENT_SOURCE=#{EVENT_SOURCE},</if> 
		    <if test="CLIENTNAME!=null"> CLIENTNAME=#{CLIENTNAME},</if> 
		    <if test="REPORT_CITY!=null"> REPORT_CITY=#{REPORT_CITY},</if> 
		    <if test="ENFORCE_TIME!=null"> ENFORCE_TIME=#{ENFORCE_TIME},</if> 
		    <if test="EVENT_TYPE1!=null"> EVENT_TYPE1=#{EVENT_TYPE1},</if> 
		    <if test="THREAT_LEVEL!=null"> THREAT_LEVEL=#{THREAT_LEVEL},</if> 
		    <if test="THREAT_NAME!=null"> THREAT_NAME=#{THREAT_NAME},</if> 
		    <if test="THREAT_TYPE1!=null"> THREAT_TYPE1=#{THREAT_TYPE1},</if> 
		    <if test="THREAT_TYPE2!=null"> THREAT_TYPE2=#{THREAT_TYPE2},</if> 
		    <if test="THREAT_TYPE3!=null"> THREAT_TYPE3=#{THREAT_TYPE3},</if> 
		    <if test="THREAT_TYPE4!=null"> THREAT_TYPE4=#{THREAT_TYPE4},</if> 
		    <if test="ACCESS_ID!=null"> ACCESS_ID=#{ACCESS_ID},</if> 
		    <if test="ROOM_NAME!=null"> ROOM_NAME=#{ROOM_NAME},</if> 
		    <if test="ROOM_IDX!=null"> ROOM_IDX=#{ROOM_IDX},</if> 
		    <if test="DOMAIN_NAME!=null"> DOMAIN_NAME=#{DOMAIN_NAME},</if> 
		    <if test="CC_DOMAIN!=null"> CC_DOMAIN=#{CC_DOMAIN},</if> 
		    <if test="IP!=null"> IP=#{IP},</if> 
		    <if test="ATTACK_IP!=null"> ATTACK_IP=#{ATTACK_IP},</if> 
		    <if test="SYS_RECTIFY_SUGGEST!=null"> SYS_RECTIFY_SUGGEST=#{SYS_RECTIFY_SUGGEST},</if> 
		    <if test="FINAL_RECTIFY_SUGGES!=null"> FINAL_RECTIFY_SUGGES=#{FINAL_RECTIFY_SUGGES},</if> 
		    <if test="IS_FORCE_CLOSE!=null"> IS_FORCE_CLOSE=#{IS_FORCE_CLOSE},</if> 
		    <if test="IS_WHITE_LIST!=null"> IS_WHITE_LIST=#{IS_WHITE_LIST},</if> 
		    <if test="FORCE_CLOSE_DESC!=null"> FORCE_CLOSE_DESC=#{FORCE_CLOSE_DESC},</if> 
		    <if test="RECTIFY_TERM!=null"> RECTIFY_TERM=#{RECTIFY_TERM},</if> 
		    <if test="CLOSE_TERM!=null"> CLOSE_TERM=#{CLOSE_TERM},</if> 
		    <if test="SEND_TIME!=null"> SEND_TIME=#{SEND_TIME},</if> 
		    <if test="SEND_TIMESTAMP!=null"> SEND_TIMESTAMP=#{SEND_TIMESTAMP},</if> 
		    <if test="RECTIFY_STATE!=null"> RECTIFY_STATE=#{RECTIFY_STATE},</if> 
		    <if test="RECTIFY_MEASURE!=null"> RECTIFY_MEASURE=#{RECTIFY_MEASURE},</if> 
		    <if test="FEEDBACK_TIME!=null"> FEEDBACK_TIME=#{FEEDBACK_TIME},</if> 
		    <if test="FEEDBACK_TIMESTAMP!=null"> FEEDBACK_TIMESTAMP=#{FEEDBACK_TIMESTAMP},</if> 
		    <if test="WEB_CASE_RID!=null"> WEB_CASE_RID=#{WEB_CASE_RID},</if> 
		    <if test="MAPPING_MODE!=null"> MAPPING_MODE=#{MAPPING_MODE},</if> 
		    <if test="DETIAL_COUNT!=null"> DETIAL_COUNT=#{DETIAL_COUNT},</if> 
		    <if test="ENFORCE_COUNT!=null"> ENFORCE_COUNT=#{ENFORCE_COUNT},</if> 
		    <if test="URL!=null"> URL=#{URL},</if> 
		    <if test="SNAPSHOP!=null"> SNAPSHOP=#{SNAPSHOP},</if> 
		    <if test="KEYWORDS!=null"> KEYWORDS=#{KEYWORDS},</if> 
		    <if test="MEMO!=null"> MEMO=#{MEMO},</if> 
		    <if test="MODIFIEDTIME!=null"> MODIFIEDTIME=#{MODIFIEDTIME},</if> 
		    <if test="RECORDSTATE!=null"> RECORDSTATE=#{RECORDSTATE},</if> 
		</set>
	where RID=#{RID}
</update> 

</mapper>
